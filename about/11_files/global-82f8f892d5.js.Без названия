view={_lang:void 0,getLang:function(){return void 0===this._lang&&$(function(){this._lang=$("#top-body").data("lang")?$("#top-body").data("lang"):"ru"}),this._lang},translate:function(r){var t=this.getLang();return"ru"!=t&&void 0!=r&&""!=r&&void 0!=window.Translate?Translate[r]||r:r},query:function(r,t,o,n,e,i,a){var s=e||"json",u=n||{},l=a||{};$.ajax({url:r,type:"POST",dataType:s,data:u,timeout:3e4,success:function(r,n){try{if(r&&1==r.success)t(r,n);else if(void 0!=i&&i(r,n),void 0==i||void 0!=l.showError&&1==l.showError){var e;if(e=l.msg?l.msg:"json"==s?void 0!=r.msg?r.msg:"":$(r).closest(".block-error").length>0?$(r).html():"",!r.type||"warning"!=r.type)throw new Error(e);ntNotification.showWarning(r.message),Popup.progressBar("hide")}}catch(a){Notifier.showError(a.message,o)}},error:function(r,t){var n=Notifier.getErrorTpl(t);Notifier.showError(n,o),Popup.progressBar("hide")}})},scrollTo:function(r,t){if(0==$("#"+r).length)return!1;t=500|t;var o=$("#"+r).offset();return $("body, html").animate({scrollTop:o.top},t),!0},toogleBlockByClick:function(r,t){var o=$(r);$(document).on("click",o.selector,function(){return $(t).toggle(),!1})},array_unique:function(r){for(var t=[],o=r.length,n=0;o>n;n++){for(var e=n+1;o>e;e++)r[n]===r[e]&&(e=++n);t.push(r[n])}return t},isInt:function(r){return!isNaN(r)&&parseInt(r)==r&&!/^0[x|X]\.*/i.test(r)&&r>=0},getTld:function(){return $("body").data("tld")},setPhoneValidator:function(){var r=view.getTld(),t=/^$/i;switch(r){case"ru":t=/^\+7\(\d{3}\)\d{7}$/i;break;case"ua":t=/^\+380\(\d{3}\)\d{7}$/i}return jQuery.validator.addMethod("phoneNumber",function(r,o){return this.optional(o)||t.test(r)},this.translate("Введите корректный телефон")),!0}};
function showThumb(e){if(e[0]){var t=".vimeo-"+e[0].id;$(t).each(function(){$(this).attr("src",e[0].thumbnail_medium)})}}function vimeoLoadingThumb(e){var t="http://vimeo.com/api/v2/video/"+e+".json?callback=showThumb",i=".vimeo-"+e;$(i).each(function(){$(this).before('<script type="text/javascript" src="'+t+'"></script>')})}var Notifier={ask:function(e){return confirm(e)},addPreloader:function(e){0==$(e).find(".preloader").length&&(e.append('<div class="bg">'),e.append('<div class="preloader">'))},removePreloader:function(e){0!=$(e).find(".preloader").length&&(e.find(".bg").remove(),e.find(".preloader").remove())},hasPreloader:function(e){return 0!=$(e).find(".preloader").length},getErrorTpl:function(e){return view.translate("Ошибка")+": "+e+"."+view.translate("Попробуйте запрос позже")+"."},_showPopup:function(e){var t=this;t.popupTemlate?t._initPopup(e):$.get("/html/ru_RU/utils/notifyer.html",function(i){t.popupTemlate=i,$(document).on("click",".window.notifyer .-btn",function(){Popup.closeDialog()}),$(document).on("click",".window.notifyer a",function(){return Popup.closeDialog(),t.to_href=$(this).attr("href"),!1}),t._initPopup(e)})},_initPopup:function(e){var t=this,i=$(this.popupTemlate);i.find(".header").html(e.head),i.find(".message").html(e.msg),i.addClass(e.type),i.find(".-btn").addClass("-btn-"+e.type);var n=Popup.getParams();n.padding=0,n.afterClose=function(){t.to_href&&(window.location.href="http://"+window.location.host+t.to_href,$(document).trigger("hashchange")),t.to_href=!1},Popup.showDialog(i,n)},showError:function(e,t,i,n){var a=this;i=void 0==i?!0:i,e=e?e:"Произошла ошибка. Попробуйте еще.",e=view.translate(e),n=n?n:"Произошла ошибка",n=view.translate(n),void 0!=t&&$(t).length>0?a.notify({type:"error",msg:e,el:t,hide:i}):a._showPopup({head:n,msg:e,type:"error"})},showSuccess:function(e,t,i,n){var a=this;i=void 0==i?!0:i,e=e?e:view.translate("Операция выполнена успешно"),e=view.translate(e),n=n?n:"Операция выполнена успешно",n=view.translate(n),void 0!=t&&$(t).length>0?this.notify({type:"success",msg:e,el:t,hide:i}):a._showPopup({head:n,msg:e,type:"success"})},showWarning:function(e,t,i,n){var a=this;e=e?e:view.translate("Предупреждение"),e=view.translate(e),n=n?n:"Уведомление",n=view.translate(n),a._showPopup({head:n,msg:e,type:"warning"})},showMessage:function(e,t,i,n){var a=void 0==i?!0:i;void 0!=t&&$(t).length>0?(n=n||void 0,this.notify({type:"ok",msg:e,el:t,hide:a,speedOut:n})):void 0!=e&&alert(e)},notify:function(e){var t=this.getTemplate();1==e.hide&&$("."+$(t).attr("class")).fadeOut(),$(t).addClass(e.type).html('<table><td><div id="'+e.type+'-icon"></div></td><td>'+e.msg+"</td></table>"),$(e.el).prepend($(t)),$(t).fadeIn();var i=$(e.el).position().top,n=$(e.el).scrollTop();if(n>0&&$("body,html").animate({scrollTop:i},200),1==e.hide){var a=e.speedOut||5e3;setTimeout(function(){$(t).fadeOut(),$(t).remove()},a)}},getTemplate:function(){return $('<div class="notifier"/>')},showIndicator:function(e,t){var i=this.getIndicatorBtn(e,t);this.showIndicatorBtn(i)},hideIndicator:function(e,t){var i=this.getIndicatorBtn(e,t);this.hideIndicatorBtn(i)},lockBtn:function(e){e.hasClass("disable")||e.addClass("disable")},unlockBtn:function(e){e.removeClass("disable")},showIndicatorBtn:function(e){e.attr("style","width:"+e.innerWidth()+"px"),e.addClass("locked"),e.prepend('<div class="-loader"></div>'),e.on("click.off",function(){return!1})},hideIndicatorBtn:function(e){e.removeClass("locked"),e.children(".-loader").remove(),e.attr("style",""),e.off("click.off")},getIndicatorBtn:function(e,t){var i=t||!1;return 0==i?0==$("#"+e+" button.blue, #"+e+" .-btn-complete").length?$("#"+e+" .buttons.green-btn"):$("#"+e+" button.blue,#"+e+" .-btn-complete"):$("#"+e+" footer button.blue, #"+e+" footer .-btn-complete")},getLoader:function(){return'<div id="ajax-loader"></div>'},showNotice:function(e,t,i){var n=$(e);if(n.length>0){var a=$('<div id="user-notice" style="display:none;">'+t+"</div>"),o=n.find("#user-notice");i&&o.length?o.eq(0).replaceWith(a):n.append(a),a.fadeIn(200),setTimeout(function(){a.fadeOut(200,function(){a.remove()})},2500)}},getSmallLoader:function(){return"<img id='lazy-loader' src='/img/lazyload.gif'>"},removeSmallLoader:function(){$("#lazy-loader").remove()}},Popup={loadEvents:function(){var e=this;$(document).on("click",".window .close, .window .close-link a, .window .cancel,.window .-btn-cancel",function(){return 0==$(this).parents("#comment_form").length&&(e.closeDialog(),$.jPicker&&$.jPicker.List.forEach(function(e){e.hide()})),!1})},getParams:function(){return{closeBtn:!1,enableEscapeButton:!0,margin:0,padding:2,scrolling:!1,minHeight:1,minWidth:1}},showDialog:function(e,t){var i=this,n=t||i.getParams();n=$.extend({},n,{content:e}),Visitor.bindImageViewer($,n)},showWindow:function(e,t,i,n){var a='<section class="window '+i+'" id="'+i+'-edit-window" style="width:'+n+'px"><header><div class="edit-block"><ul><li><span class="close"></span></li></ul></div><h1>'+view.translate(t)+'</h1></header><div id="windowContent">'+e+"</div></section>";this.showDialog(a)},closeDialog:function(){$.fancybox.close()},progressBar:function(e){"show"==e?$.fancybox.showLoading():$.fancybox.hideLoading()},center:function(){}};Visitor={init:function(){this.setTooltip(),$("#footer").append($('<div id="temp-block"/>')),this.loadEvents(),this._initValidate(),this.decorateContent(),Popup.loadEvents();var e=$("#top-body").data("lang");this.lang=void 0==e?"ru":e,this.scrollWindow=0,this.isFancyLoad=!1,this.setSrcToFrameMap(),setTimeout(function(){Visitor.checkViewer()},1e3),this.addValidateMethods(),this.subscriberAddFormValidate(),this.initCatalogPriceFilter(),OneClickBuy.init(),this.formsHashHandler(),$(window).on("hashchange",$.proxy(function(){this.formsHashHandler()},this)),this.initDropDown(),$(document).on("widget_set_content",function(e,t){11==t&&(this.initDropDown(),Visitor.initCatalogPriceFilter())}.bind(this)),this.initTab()},initCatalogPriceFilter:function(){var e=$("#catalog_price_filter");if(0!=e.length){var t,i,n=$("#catalog_price_filter_min_cost"),a=$("#catalog_price_filter_max_cost");i=n.data("min-cost")?parseInt(n.data("min-cost")):0,t=a.data("max-cost")?parseInt(a.data("max-cost")):1e4,e.html(""),n.val()||n.val(i),a.val()||a.val(t),noUiSlider.create(e[0],{start:[parseInt(n.val()),parseInt(a.val())],range:{min:i,max:t},format:{to:function(e){return parseInt(e)},from:function(e){return e}},connect:!0}),e[0].noUiSlider.on("update",function(e,t){1==t?a.val(e[t]):n.val(e[t])}),n.on("change",function(){e[0].noUiSlider.set([n.val(),a.val()])}),a.on("change",function(){e[0].noUiSlider.set([n.val(),a.val()])})}},setTooltip:function(){$(document).on("mouseover",".tooltip:not(.tooltipstered)",function(){var e=$(this);e.tooltipster({touchDevices:!1}),e.tooltipster("show")})},addValidateMethods:function(){$.validator.setDefaults({onclick:function(e,t){$(e).valid()&&$(e).removeClass("error")},onkeyup:function(e,t){(9!==t.which||""!==this.elementValue(e))&&$(e).valid()&&$(e).removeClass("error")}}),$.validator.addMethod("identity",function(e,t){var i=e.trim();return this.optional(t)||/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(i)},view.translate("Введите корректный email")),$.validator.addMethod("phone",function(e,t){var i=e.trim();return this.optional(t)||/^[+]?(\d)+$/i.test(i)})},loadEvents:function(){var e=this;$(document).on("click",".ddelivery-map",function(){var e=$(this).data("city-type");Popup.showDialog('<iframe src="http://service.ddelivery.ru/demodev/ddelivery/ajax.php?iframe=1&amp;config_type=3&amp;width=900&amp;height=580&config_city='+e+'" height="600" width="920"></iframe>',{closeBtn:!1,enableEscapeButton:!0,margin:0,padding:[20,0,0,20],scrolling:!1,minHeight:1,minWidth:1})}),e.scrllWidth=e.scrollbarWidth(),$(document).on("click",".mailerForm .send",function(){$(".mailerForm form").submit()}),$(document).on("click","#topcontacts .feedback-btn",function(e){Feedback.init($(this).data("type"))}),$(document).on("click","#up-link",function(t){return e.scrollTop(t)}),$(document).on("mouseover","#up-link",function(){$(this).stop(!0,!0).animate({opacity:1},200)}),$(document).on("mouseout","#up-link",function(){$(this).stop(!0,!0).animate({opacity:.4},200)}),$(window).scroll(function(){e.showUpLink(this)}),$(document).on("click",".buttons.order",function(){e.makeOrder(this)}),document.onkeydown=function(t){e.keyEvents(t)},$(document).on("mouseover.fancy",".fancy-img",function(){return e.bindImageViewer($(".fancy-img"),{beforeShow:function(){$(".fancybox-skin").addClass("site-popup")}}),$(document).off("mouseover.fancy",".fancy-img"),!1}),$(document).on("click",".fancy-img-post",function(){var t=$(this);t.parent().is("a")||0!=t.parents(".mr-block").length||e.bindImageViewer($,{element:{context:{id:t.attr("id")}},href:t.attr("data-eval"),beforeShow:function(){$(".fancybox-skin").addClass("site-popup")}})}),$(document).on("click",".video-intext",function(){e.getVideo(this)}),$(document).on("click",".buttons.disable",function(){return!1}),$(document).on("click",".video-item a, .video-link",function(){e.showVideo($(this))}),$(document).on("click",".fancybox-wrap.can-close",function(e){e.target==this&&$.fancybox.close()}),$(document).on("click","#contactsmain-left .ymap, #contactsmain .ymap, #contactsmain-left .gmap, #contactsmain .gmap, #contactsmain-left .2gismap, #contactsmain .2gismap",function(){return e.findAddress(this),!1}),$(document).on("click","#sharebyemail-edit-window footer .save",function(){$("form#sharebyemail").submit()}),$(document).on("click",".error-window .ok,.success-window .ok",function(){Popup.closeDialog()}),$(document).on("click",".top-news .popup",function(){return e.getUrgentMessage()}),$(document).on("click","#blog-posts-lnk",function(){return e.setPostCounterNull()}),$(document).on("change","select#translate",function(){return e.toggleLanguage(this)}),$(document).on("click",".fancybox-wrap .show-form a",function(){return $(this).parent().parent().find("form").slideToggle(),!1}),$(document).on("click",".fancybox-wrap #comment_wrap .show-all",function(){$(this).remove(),$(".fancybox-wrap .comment_wrap").show()}),$(document).on("click","#fancybox-right.photos",function(){$(".album-items-wrap li.curr-"+$(this).data("next")).trigger("click")}),$(document).on("click","#fancybox-left.photos",function(){$(".album-items-wrap li.curr-"+$(this).data("prev")).trigger("click")}),this.viewPhoto(),this.viewCommentImageAttachment(),$(document).on("click",".share-links a:not(.mail-average-icon)",function(){e.ShareLinks(this)}),$(document).on("click",".share-links a.mail-average-icon",function(){e.getShareByMailForm($(this))});var t=$("#catalogsortable select[name=sort], #catalogsortable select[name=categoryId]").each(function(){var e=$(this);e.attr("data-current-val",e.val())});$(document).on("widget_set_content",function(e,t){t==Nethouse.WIDGETS.TYPE_PRODUCTS&&$("#catalogsortable select[name=sort], #catalogsortable select[name=categoryId]").each(function(){var e=$(this);e.attr("data-current-val",e.val())})});var i=$(".catalog-filter-group select#productGroupSelector, .selectorGroup select#productGroupSelector");$(document).on("change",i.selector,function(e){var t=$(e.target),i=t.parents("form"),n=i.find("input[name=productGroup]"),a=i.find("input[name=productCustomGroup]"),o=t.find("option:selected"),r=o.attr("data-group-id"),s=o.attr("data-group-entity-id");(r!=n.val()||s!=a.val())&&(n.val(r),a.val(s),i.submit())}),$(document).on("change",t.selector,function(e){var t=$(e.target);t.data("current-val")!=t.val()&&t.parents("form").submit()}),$(document).on("change","#catalogsortable input[type=checkbox]",function(e){$(this).parents("form").submit()}),view.setPhoneValidator()},showVideo:function(e){var t=this;$.post(e.attr("data-video-href"),function(e){e.success?t.bindImageViewer($,{content:e.block,padding:0,className:"fancy-video",scrolling:!1,beforeShow:function(){$(".fancybox-skin").addClass("imageGallery");var i=$("#video-content .item-content").attr("id").replace("item","");e.nocomment||$.post("/get/commentswindow",{object:i,type:Comments.types.video},function(e){if(e.success){var i,n=$(e.block);n.hide(),$(".fancybox-inner .item-info").append(n),$(".fancybox-inner .item-info .comments-block").slideDown(),t.bindInputCharCounter(),i=$(".fancybox-inner #comment_form"),Comments.initFormImages(i),Comments.initImageUpload(i),Comments.validateWindowForm(i),"undefined"!=typeof CommentsUser&&CommentsUser.reloadEvents()}else ntNotification.showError("Произошла ошибка. Видео не найдено.")},"json")}}):ntNotification.showError("Произошла ошибка. Видео не найдено.")},"json")},getShareByMailForm:function(e){var t=this,i={id:e.attr("data-id"),type:e.attr("data-type"),token:e.attr("data-token")},n="/getmailform";$.post(n,i,function(e){e.success&&(Popup.showDialog(e.form),t.shareByMailFormValidate())})},shareByMailFormValidate:function(){$("form#sharebyemail").validate({submitHandler:function(e){return Notifier.showIndicator("sharebyemail"),$(e).ajaxSubmit({success:function(t,i,n){Notifier.hideIndicator("sharebyemail");try{if(t.success)Popup.showDialog(t.success_window);else if(void 0!=t.error)Popup.showDialog(t.error);else{if(t.error==e)throw new Error("");Popup.showDialog(t.form)}}catch(a){ntNotification.showError(a.message)}}}),!1},focusInvalid:!1,focusCleanup:!0,rules:{email:{required:!0,email:!0}},messages:{email:{required:view.translate("Пожалуйста, укажите email адрес"),email:view.translate("Введите корректный email")}},errorPlacement:function(e,t){error_item=t.parent().parent().find(".state_field"),e.appendTo(error_item)},highlight:function(e){$(e).attr("id");$(e).parent().parent().find(".state_field").addClass("red"),$(e).addClass("error")},unhighlight:function(e){$(e).parent().parent().find(".state_field").removeClass("red"),$(e).removeClass("error")}})},ShareLinks:function(e){var t=$(e).attr("href"),i=[560,472],n=screen.width?(screen.width-i[0])/2:0,a=screen.height?(screen.height-i[1])/2:0,o="height="+i[1]+",width="+i[0]+",top="+a+",left="+n+",scrollbars=yes,resizable";return window.open(t,"SocialNet",o),!1},getVideo:function(e){var t=this,i=$(e).prop("class").replace("video-intext ",""),n=$(e).prop("alt").replace(/<(\/)?(\s)*script(\s)*>/,""),a=$(e).prop("id").replace(/<(\/)?(\s)*script(\s)*>/,""),o=$(e).prop("title").replace(/<(\/)?(\s)*script(\s)*>/,""),r=t.VideoConfig[i].content.replace(/\#/g,a);r='<div id="video-content" class="video" style="width: 740px;" data-code="'+a+'"><div class="item-content"><header><h1 class="video__header">'+o+'</h1></header><div class="video__content">'+r+'<div class="video__stub"><div class="video-desc video__desc">'+n+"</div></div></div></div></div>",Visitor.bindImageViewer($,{content:r,padding:0,className:"fancy-video",beforeShow:function(){$(".fancybox-skin").addClass("imageGallery")}})},VideoConfig:{youtube:{image:"http://img.youtube.com/vi/?/default.jpg",regexp:/(?:(?:youtube\.com\/watch\?(?:[\w\d]+\=[\w\d]+\&)*v\=)|(?:youtu\.be\/)|(?:youtube\.com\/user\/[\w\d]+(?:\?(?:[\w\d]+\=[\w\d]+[\&]?)+)?#p\/(?:[\w]\/){0,4}[\d]+\/))([_a-zA-Z0-9-]+)/i,content:'<iframe width="700" height="390" src="http://www.youtube.com/embed/#?rel=0" frameborder="0" allowfullscreen></iframe>'},youtu:{image:"http://img.youtube.com/vi/?/default.jpg",regexp:/(?:(?:youtube\.com\/watch\?(?:[\w\d]+\=[\w\d]+\&)*v\=)|(?:youtu\.be\/)|(?:youtube\.com\/user\/[\w\d]+(?:\?(?:[\w\d]+\=[\w\d]+[\&]?)+)?#p\/(?:[\w]\/){0,4}[\d]+\/))([_a-zA-Z0-9-]+)/i,content:'<iframe width="700" height="390" src="http://www.youtube.com/embed/#?rel=0" frameborder="0" allowfullscreen></iframe>'},rutube:{image:"http://tub.rutube.ru/thumbs-wide/?-2.jpg",regexp:/(?:(?:rutube\.ru\/tracks\/[0-9]+\.html\?v\=)|(?:video\.rutube\.ru\/))([_a-zA-Z0-9]+)/i,content:'<iframe width="700" height="390" src="http://rutube.ru/video/embed/#" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowfullscreen></iframe>'},vimeo:{image:"",regexp:/vimeo\.com\/([0-9]+)/i,content:'<iframe src="http://player.vimeo.com/video/#?title=0&amp;byline=0&amp;portrait=0" width="700" height="390" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>'}},showUpLink:function(e){var t=document.body.clientWidth,i=$("#up-link");t>1100&&$(e).scrollTop()>400?i.fadeIn():i.fadeOut(200)},scrollTop:function(e){return $("body,html").animate({scrollTop:0},200),e.preventDefault(),!1},keyEvents:function(e){if(e=e||window.event,27==e.keyCode){var t=$(".on-edit:not(.static)").not("#comment-edit");t.length>0&&Site.toggleBlock(),$.jPicker&&$.jPicker.List.forEach(function(e){e.hide()})}},decorateContent:function(){$(document).on("widget_init",function(){$("#content").find(".user-inner li:not(:has(i.circles))").prepend('<i class="circles"></i>')}),$("#content").find(".user-inner li:not(:has(i.circles))").prepend('<i class="circles"></i>')},makeOrder:function(e){$forOrder=$(e).parents(".content-block").attr("id").replace("-show","");var t=$(e).parents(".item-content"),i="";return t.length>0&&(i=$(t).attr("id").replace("item","")||""),Feedback.init($forOrder,{sid:i,order:!0})},_initValidate:function(){$.validator.setDefaults({showErrors:function(e,t){return t.length<1?void $("ul.errors").remove():void $.each(t,function(e,t){var i=$(t.element);i.removeClass("valid").addClass("error"),i.is('input[type="checkbox"]')||(i.removeClass("valid").addClass("error"),i.next("ul.errors").remove(),i.after($("<ul/>").addClass("errors").append($("<li/>").text(t.message))))})}})},preloadBannerImages:function(e){if("undefined"!=typeof document.body)try{$("#banner-carousel").html(Notifier.getLoader());var t=document.createElement("div"),i=t.style;i.position="absolute",i.top=i.left=0,i.display="none",document.body.appendChild(t);for(var n in e){var a=document.createElement("img");a.src=e[n],t.appendChild(a)}BannerShow()}catch(o){}},ymaploaded:function(e){var t=$(e).attr("src");void 0!=t&&"about:blank"!=t&&$("#ymap-container #ajax-loader").remove()},findAddress:function(e){var t=$(e),i=t.prevAll(".address-value"),n=(i.html(),i.data("geolat"),i.data("geolng"),i.data("geozoom"));n=n||0;var a="ymap";t.hasClass("gmap")?a="gmap":t.hasClass("2gismap")&&(a="2gismap");var o=(t.data("host"),t.data("lang"),t.attr("href"));Popup.showDialog('<div id="map-container"><div id="ajax-loader"></div><iframe id="map-frame" width="600" height="450" marginheight="0" marginwidth="0" frameborder="0" src=""></iframe></div>',{closeBtn:!0,padding:10});var r=$("#map-frame");r.attr("src",o),r.load(function(){var e=$(this).attr("src");void 0!=e&&"about:blank"!=e&&$("#map-container #ajax-loader").remove()})},setSrcToFrameMap:function(){var e=$("#main-contacts .address ul iframe[id^=ymap-], #main-contacts .address ul iframe[id^=gmap-], #main-contacts .address ul iframe[id^='2gismap-']");return e.length&&e.each(function(){var e=$(this);if(void 0!=e.attr("src"))return!0;var t=e.attr("id"),i=t.replace(/-\d+/,"");"ymap"!=i&&"gmap"!=i&&"2gismap"!=i&&(i="ymap");var n=$(this).data("host"),a=$(this).data("lang"),o=$(this).prevAll("span.address-value").data("geolat"),r=$(this).prevAll("span.address-value").data("geolng"),s=$(this).prevAll("span.address-value").data("geozoom");s=s||0;var c=$(this).prevAll("span.address-value").html(),d="http://"+n+"/"+i+"/addr/"+c+"/"+s+"/w/550/h/300/embedded/"+a;void 0!=o&&void 0!=r&&(d="http://"+n+"/"+i+"/coords/"+o+";"+r+"/"+s+"/w/550/h/300/embedded/"+a),$(this).attr("src",d)}),!1},getUrgentMessage:function(){var e="/geturgentcontent",t={pid:$(".top-news").data("mid")},i=function(e){Popup.showDialog(e.content)};return view.query(e,i,null,t),!1},setPostCounterNull:function(){var e=$("#blog-counter");if(e.length>0){var t="/markpostread",i={type:"all"},n=function(){e.hide()};view.query(t,n,null,i)}},toggleLanguage:function(e){var t=$(e).val()||"ru";return view.query("/togglelang",function(e){void 0!=e.success&&1==e.success&&window.location.reload()},"",{lang:t}),!1},bindImageViewer:function(e,t){var i=this;if(void 0!==e&&e.length){var n=function(){};t=t||{},t.fitToView=!1,t.fixed=!1,t.scrolling=t.scrolling||"no",t.nextEffect="none",t.prevEffect="none",t.openEffect="fade",t.openSpeed="slow",t.iframe={preload:!1},t.minHeight=1,t.live=!0,t.minWidth=1,t.beforeShow&&(n=t.beforeShow);var a=function(){};t.afterLoad&&(a=t.afterLoad);var o=function(){};t.beforeLoad&&(o=t.beforeLoad);var r=function(){};t.afterClose&&(r=t.afterClose),t.beforeLoad=function(){return i.fancy=this,$.fancybox.showLoading(),o()},t.beforeShow=function(){"html"==i.fancy.type&&void 0==i.fancy.isGallery&&(i.fancy.height=$(".fancybox-inner").innerHeight()),$("html").addClass("modal-open"),$.fancybox.hideLoading();var e=$(".fancybox-wrap");e.addClass(t.className),e.addClass("imageviwer"),t.clickBlocked||e.addClass("can-close");var a=t.href||i.fancy.href;if(a){var o;if(/\/img\//.test(a)){var r=i.fancy.element.context.id.split("-");r[1]&&i.changeLocationHash("#img-"+r[1])}else/http:\/\/.*\/video/.test(a)&&(o=a.replace(/http:\/\/.*\/video\//,""),o&&i.changeLocationHash("#video-"+o))}else{var s=this.content,c=$(s).closest("#video-content").data("code");c&&i.changeLocationHash("#video-c_"+c)}n(),i.isFancyLoad=!0},t.afterClose=function(e){if($("html").removeClass("modal-open"),window.location.hash.length>1)if(window.history&&window.history.replaceState){var t=window.location.pathname+window.location.search;window.history.replaceState({},"",t)}else window.location.hash=" ";r(e),i.isFancyLoad=!1},e.fancybox(t)}},scrollbarWidth:function(){var e,t=$("body"),i=$('<div style="position: absolute; left: -100000px; height: 100px; width: 100px;"></div>');return t.append(i),e=i.width(),i.css("overflow","scroll"),e-=i.width(),e||(e=i.width()-i[0].clientWidth),i.remove(),$("head").append('<style type="text/css">.modal-open { padding-right: '+e+"px } .scroll-width { padding-right:"+e+"px }</style>"),e},checkViewer:function(){var e=window.location.hash;if(/^#img-.*$/.test(e)){var t=e.split("-");if(null===t)return;t=t[1],$("#view-"+t).trigger("click");var i=new RegExp("^.*"+t+".*$");$("a.fancy-img, img.fancy-img-post, li.view-photo a").each(function(){$this=$(this);var e="";return $this.is("a")?e=$this.attr("href"):$this.is("img")&&(e=$(this).data("eval")),i.test(e)?($this.trigger("click"),!1):void 0})}else if(/^#video-\d*$/.test(e)){var n=e.match(/^#video-(\d+)$/);if(null===n)return;n=n[1];var i=new RegExp("^.*#video-"+n+".*$");$("a.video-link,.video-item a:not(.video-link)").each(function(){var e=$(this).attr("href");return i.test(e)?($(this).trigger("click"),!1):void 0})}else if(/^#video-c_\w+$/.test(e)){var a=e.match(/^#video-c_(\w+)$/);if(null===a)return;a=a[1],$("#"+a).trigger("click")}},changeLocationHash:function(e){window.history&&window.history.replaceState?window.history.replaceState({},"",e):window.location.hash=e},viewPhoto:function(e){var t,i=this,n=900;return i.bindImageViewer($("#photoalbum-show .view-photo > a"),{beforeShow:function(){var e=$(i.fancy.element).attr("id").replace("view-","");i.fancy.autoHeight=!0,void 0!=i.getcomments&&i.getcomments.abort(),i.getcomments=$.post("/get/commentswindow",{object:e,type:Comments.types.images},function(e){if(e.success){var t,n=$(e.block);n.hide(),$(".fancybox-inner #windowContent #photo-header").append(n),$(".fancybox-inner #windowContent .comments-block").slideDown(),i.bindInputCharCounter(),t=$(".fancybox-inner #comment_form"),Comments.initFormImages(t),Comments.initImageUpload(t),Comments.validateWindowForm(t),"undefined"!=typeof CommentsUser&&CommentsUser.reloadEvents()}},"json")},afterLoad:function(){$(".fancybox-skin").addClass("imageGallery");var e,a,o,r,s=window.screen.availHeight-200,c=600,d=$(".nt-gallery-template"),l=d.find("header").outerHeight(),u=d.find("#photo-wrapper").height();c=t>c?t:c,""!=$.trim(d.find("#view-photo-desc .text").text())&&d.find("#view-photo-desc .placeDesc").hide(),e=i.fancy.width/i.fancy.height,a=0,1>e?a=i.fancy.height>s?e*s:i.fancy.width:(a=i.fancy.width>n?n:i.fancy.width,a/e>s&&(a=e*s)),o=a/e,i.fancy.tpl.next='<a style="top: '+l+"px;height: "+u+'px" class="fancybox-nav fancybox-next"><span></span></a>',i.fancy.tpl.prev='<a style="top: '+l+"px;height: "+u+'px" class="fancybox-nav fancybox-prev"><span></span></a>',r=c>a?c:a;var f=d.find("#photo-src");f.width(a),f.height(o),d.find("#windowContent").width(r),i.fancy.content=d.html(),i.fancy.width=r,d.remove(),i.fancy.type="html"},beforeLoad:function(){i.fancy.isGallery=!0;var e=$(i.fancy.element).parent();i.showImage=!1;var n=$("#photoview-tpl").html(),a=($(e).data("raw"),$(e).parents(".album-items-wrap")),o=$(e).data(),r=a.hasClass("homepage"),s=a.data();if(r){var c=$(e).find(".view-photo-href").data();s=$.extend(s,c)}for(var d in o)n=n.replace(new RegExp("{:"+d+"}","g"),o[d]);for(var l in s)n=n.replace("{:"+l+"}",s[l]);$(".nt-gallery-template").length>0&&$(".nt-gallery-template").remove();var u=$('<div class="nt-gallery-template">'+n+"</div>");u.css({position:"absolute",left:"-20000px"});var f=u.find("#view-photo-desc");f.hide(),u.appendTo($("body")),t=u.width(),f.show()},beforeClose:function(){}}),!1},viewCommentImageAttachment:function(){var e,t=this,i=900,n=$(".js-comment-image-link");return t.bindImageViewer(n,{beforeLoad:function(){t.fancy.isGallery=!0,t.showImage=!1;var i=$(t.fancy.element),n=$(i).data(),a=$(".js-imageAttachmentView-tpl").html();for(var o in n)a=a.replace(new RegExp("{:"+o+"}","g"),n[o]);var r=$('<div class="nt-gallery-template">'+a+"</div>");r.css({left:"-20000px",position:"absolute"});var s=r.find("#view-photo-desc");s.hide(),r.appendTo($("body")),e=r.width(),s.show()},afterLoad:function(){$(".fancybox-skin").addClass("imageGallery");var n,a,o,r,s=window.screen.availHeight-200,c=600,d=$(".nt-gallery-template");d.find("header").outerHeight(),d.find("#photo-wrapper").height();c=e>c?e:c,""!=$.trim(d.find("#view-photo-desc .text").text())&&d.find("#view-photo-desc .placeDesc").hide(),n=t.fancy.width/t.fancy.height,a=0,1>n?a=t.fancy.height>s?n*s:t.fancy.width:(a=t.fancy.width>i?i:t.fancy.width,a/n>s&&(a=n*s)),o=a/n,r=c>a?c:a;var l=d.find("#photo-src");l.width(a),l.height(o),d.find("#windowContent").width(r),t.fancy.content=d.html(),t.fancy.width=r,d.remove(),t.fancy.type="html"}}),!1},getPhotos:function(e,t,i){var n="/photoalbum/load/getalbumphotos",a=function(e){var t=$(e.data).find("li.view-photo");if(t.length>0){t.css("display","none");var n=$("#photoalbum-show ul.album-items-wrap");i?n.append(t):n.prepend(t)}},o=function(){Notifier.hideIndicator("windowContent",!0)};return view.query(n,a,"#windowContent",{aid:e,page:t,isView:!0},"json",o,{showError:!0}),!1},charCounter:function(e,t,i,n){void 0!==n&&n===!1&&(e=e.replace(/(<\/?[^>]+>)|(&nbsp;)/gi,""));var a=t-e.length;0>a&&(a=0),i.html(a)},bindInputCharCounter:function(){var e=this,t='<span class="infoDigits char_info">'+view.translate("Осталось символов")+': <span class="char_limit"></span></span>';$("input, textarea:visible, #comment_form textarea").each(function(){var i,n=$(this),a=n.data("charcounter");if(i=n.attr("maxlength")){var o,r;if(n.parents("dd").length&&"no"!=a){r=n.attr("id");var s=n.parents("dl").find("dt#"+r+"-label");s.find("span.char_info").length||s.prepend(t),o=$("#"+r+"-label .char_info .char_limit")}else"yes"==a&&(r=n.attr("id"),n.parent().find("span.char_info").length||n.parent().prepend(t),o=n.parent().find("span.char_info .char_limit"));void 0!==r&&$("#"+r).unbind(".limit").bind("change.limit keyup.limit",function(){e.charCounter($(this).val(),i,o)}).triggerHandler("change.limit")}})},bindInputCharCounterByElement:function(e){var t,i=this,n='<span class="infoDigits char_info">'+view.translate("Осталось символов")+': <span class="char_limit"></span></span>',a=e.data("charcounter");if(t=e.attr("maxlength")){var o,r;if(e.parents("dd").length&&"no"!=a){r=e.attr("id");var s=e.parents("dl").find("dt#"+r+"-label");s.find("span.char_info").length||s.prepend(n),o=$("#"+r+"-label .char_info .char_limit")}else"yes"==a&&(r=e.attr("id"),e.parent().find("span.char_info").length||e.parent().prepend(n),o=e.parent().find("span.char_info .char_limit"));void 0!==r&&$("#"+r).unbind(".limit").bind("change.limit keyup.limit",function(){i.charCounter($(this).val(),t,o)}).triggerHandler("change.limit")}},subscriberAddFormValidate:function(){$('form#subscriber-add-form input[type="text"]:visible:not([placeholder])').focus(function(){var e=$(this),t=e.val(),i=e.data("default");t==i&&e.val("")}).blur(function(){var e=$(this),t=e.val(),i=e.data("default");""==t&&e.val(i)}),$("form#subscriber-add-form").validate({submitHandler:function(e){return Notifier.showIndicator("subscribe-left"),$(e).ajaxSubmit({success:function(e){Notifier.hideIndicator("subscribe-left");try{if(void 0!=e.form){var t=$(e.form).find('input[id*="csrf"]');t.length&&$("#subscriber-add-form").find('input[id*="csrf"]').replaceWith(t)}void 0!=e.success&&1==e.success?Popup.showDialog(e.success_window):ntNotification.showError("Ошибка при добавлении подписчика")}catch(i){ntNotification.showError(i.message)}}}),!1},focusInvalid:!0,focusCleanup:!1,errorClass:"error",rules:{name:{required:!0,minlength:1},email:{required:!0,email:!0}},messages:{name:{required:view.translate("Пожалуйста, укажите свое имя")},email:{required:view.translate("Пожалуйста, укажите email адрес"),email:view.translate("Введите корректный email")}}})},formsHashHandler:function(){var e,t=location.hash;void 0!==t&&""!==t&&null!==t&&(e=function(){switch(!0){case/\#(\/)?feedback/.test(t):return"a.feedback-btn[data-type=0]";case/\#(\/)?callback$/.test(t):return"a.feedback-btn[data-type=1]";case/\#(\/)?order\-form/.test(t):return"button.order, .buttons.order";case/\#(\/)?one\-click\-form/.test(t):return"a.one-click-order-btn";default:return""}}.call(this),null!==$(e)&&$(e).length>0&&$(e).trigger("click"))},initDropDown:function(){$(".ui.dropdown").on("click",function(e){e.stopPropagation()}),$(".ui.dropdown:not(.with-inputs)").each(function(e,t){t=$(t),t.find("label.item").removeClass("active");var i=t.children(".text").addClass("default");i.attr("data-text")||i.attr("data-text",i.text()),t.dropdown({useLabels:!1,message:{count:i.attr("data-text")+" ({count})"}})}),$(".ui.dropdown.with-inputs").dropdown({useLabels:!1,action:"nothing"}),$(".ui.dropdown.menu").dropdown({action:"nothing",transition:"fade",keepOnScreen:!0})},initTab:function(){$("#product-full-desc .paths .menu .item").on("click",function(e){e.stopPropagation()}),$("#product-full-desc .paths .menu .item").tab({context:"#product-full-desc .paths"})}};var d=document,ie=d.all&&!window.opera,op="",OneClickBuy={selector:"a.one-click-order-btn",formSelector:"form.order-by-click",link:void 0,init:function(){$(this.selector).length>0&&this.initEventListener()},initEventListener:function(){var e=this;$(document).on("click",this.selector,function(t){setTimeout(function(){e.openModal($(e.selector),t)},200)})},handleFormSubmit:function(){var e=$(this.formSelector).parents(".window").find("button.send"),t=this;e.length>0&&$(e).click(function(e){e.preventDefault(),$(t.formSelector).submit()})},openModal:function(e,t){var i=$(e).attr("data-product-id"),n=$(e).attr("data-href"),a=this,o=$("#product-params-view"),r=[];return o.length>0&&(r=window.Nethouse.cart.getParamsValues(o),
!r.length)?(ntNotification.showWarning("Выберите все параметры",4e3),void t.preventDefault()):void Nethouse.Modal.openHtmlAjax(n,{opts:{type:"POST",data:{productId:i,selectedParams:JSON.stringify(r)}},error:"Ошибка при загрузке формы",open:function(){a.addFieldsValidators(),a.handleFormSubmit()}})},addFieldsValidators:function(){$(this.formSelector).validate({focusInvalid:!1,focusCleanup:!0,rules:{clientName:{required:!0},clientPhone:{required:!0,phone:!0}},messages:{clientName:{required:view.translate("Введите корректное имя")},clientPhone:{required:view.translate("Введите номер телефона")}}})}};Feedback={init:function(e,t){return this.type=e,this.params=t||{},this.loadEvents(),this.showFeedback(),this.id="feedback"==e?"feedback-edit-window":"services-edit-window",!1},loadEvents:function(){},showFeedback:function(){var e,t=this;if(this.params.order)e="/"+this.type+"/load/makeorder",this.params.type=this.type,i=this.params;else{e="/mailer/getform";var i={type:this.type}}return Nethouse.Modal.openHtmlAjax(e,{opts:{type:"POST",data:i},error:"Ошибка при загрузке формы",open:function(){$(t.windowId).addClass(t.type),t.submitFeedback($("#"+t.type+"-order-form"))}}),!1},submitFeedback:function(e){var t=this,i=$(e);return e.validate({submitHandler:function(e){var i=t.type+"-edit-window";Notifier.showIndicator(i,!0),$(e).ajaxSubmit({dataType:"json",success:function(e){Notifier.hideIndicator(i,!0);try{if(void 0!=e&&1==e.success)Nethouse.Modal.close(),setTimeout(function(){ntNotification.showSuccess(view.translate("Форма успешно отправлена"))},300);else{var n=e.msg||view.translate("Ошибка при отправке письма!");Notifier.showError(n,"#"+t.id+" #windowContent")}}catch(a){ntNotification.showError(a)}}})},focusInvalid:!1,focusCleanup:!0,rules:t.feedbackRules(e),messages:t.feedbackErrors(e)}),(i.is("#products-order-form")||i.is("#services-order-form"))&&t.initUploadFile(e),!0},initUploadFile:function(e){var t=this,i=["doc","docx","xls","xlsx","pdf","jpg","jpeg","gif","png","zip","rar"],n=$(e),a="fancybox-content";n.is("#products-order-form")?a="products-edit-window":n.is("#services-order-form")&&(a="services-edit-window");var o=n.find(".attach-btn a"),r=t.getUid(),s="/putdocpub?X-Progress-ID=";new AjaxUpload(o,{action:s+r,name:"file",responseType:"json",onSubmit:function(e,c){r=t.getUid(),this._settings.action=s+r,Notifier.showIndicator(a);var d=i.join("|"),l=new RegExp("^("+d+")$");return c=c.toLowerCase(),c&&l.test(c)?void t.startProgressUpload(o,r):(Notifier.hideIndicator(a),Notifier.showError(view.translate("Поддерживаемые форматы")+": "+i.join(", ").toUpperCase()+".",n),!1)},onComplete:function(e,i){if(i.success&&1==i.success&&i.url){var o=i.url,r=i.name,s=i.size,c=i.timestamp;n.find("#attach-url").val(o),n.find("#attach-name").val(r),n.find("#attach-size").val(s),n.find("#attach-timestamp").val(c);var d=n.find(".attach-info .file-info");d.find(".attach-file-name").html(r);var l=t.getHumanReadableFileSize(s);d.find(".attach-file-size").html(l),d.parent().show(),n.find(".attach-btn").hide();var u=t.getFileIcon(r);u&&n.find(".file-icons").addClass(u)}Notifier.hideIndicator(a)}})},getHumanReadableFileSize:function(e){e=parseInt(e);var t;return t=e>=1048576?Math.round(e/1048576*10)/10+" Мб":e>=1024?Math.round(e/1024*10)/10+" кб":e+" б"},getFileIcon:function(e){e=e.toLowerCase();var t={pdf:[/pdf$/],xls:[/xls$/,/xlsx$/],jpg:[/jpg$/,/jpeg$/],psd:[/psd$/],mp3:[/mp3$/],gif:[/gif$/],ai:[/ai$/],eps:[/eps$/],png:[/png$/],zip:[/zip$/],rar:[/rar$/],txt:[/txt$/],rtf:[/rtf$/],doc:[/doc$/,/docx$/],ppt:[/ppt$/,/pptx$/],djvu:[/djvu$/,/djvue$/],fb:[/fb$/],ps:[/ps$/]},i=null;for(var n in t){var a=t[n];for(var o in a)if(a[o].test(e)){i=n;break}}return i&&(i+="-icon"),i},getUid:function(e){e=e||32;for(var t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],i="",n=0;e>n;n++){var a=Math.floor(16*Math.random())+0;i+=t[a]}return i},startProgressUpload:function(e,t){var i=this,n=$('<div id="progress"><div class="progressbar-value"></div></div>');$(e).after(n).css("display","none"),setTimeout(function(){i.updateProgress(t,n)},1e3)},updateProgress:function(id,progressbar,success){var _self=this;$.ajax({url:"/getprogress",timeout:3e3,headers:{"X-Progress-ID":id},dataType:"script",complete:function(e,t){},error:function(e,t,i){},success:function(data){var response=null;try{response=eval(data)}catch(e){response={}}var progress=0;if(void 0!=response.state)if(void 0!=success&&"function"==typeof success)success(response,id);else{if("uploading"==response.state){var size=response.size,received=response.received;progress=Math.floor(received/size*100),size!=received&&setTimeout(function(){_self.updateProgress(id,progressbar)},1e3)}else{if("starting"==response.state)return void setTimeout(function(){_self.updateProgress(id,progressbar)},500);"done"==response.state&&(progress=100)}progressbar.find(".progressbar-value").stop(!0).animate({width:parseInt(3*progress)+"px"},2e3)}}})},feedbackRules:function(e){var t=$(e).data("type"),i={FORM_TYPE_FEEDBACK:0,FORM_TYPE_CALLBACK:1,FORM_TYPE_ORDER:2},n={maxlength:1e3};"call"!=t&&(n.required=!0);var a={content:n,fio:{required:!0,maxlength:100},email:{required:!0,maxlength:50,email:!0},phone:{phone:!0,required:!0,maxlength:26}};switch(t){case"services":a.serviceName={required:!0};break;case"products":a.productName={required:!0},a.phone={phone:!0};break;case i.FORM_TYPE_FEEDBACK:a.phone={required:!1};break;case i.FORM_TYPE_CALLBACK:}return a},feedbackErrors:function(){var e={content:{maxlength:view.translate("Введено больше символов"),required:view.translate("Обязательное поле")},fio:{maxlength:view.translate("Введено больше символов"),required:view.translate("Обязательное поле")},email:{maxlength:view.translate("Введено больше символов"),required:view.translate("Обязательное поле"),email:view.translate("Неверный формат почты")},phone:{phone:view.translate("Только цифры и +. Пример: +79123456789"),maxlength:view.translate("Введено больше символов"),required:view.translate("Обязательное поле")}};switch(this.type){case"services":e.serviceName={required:view.translate("Выберите услугу")};break;case"products":e.productName={required:view.translate("Выберите товар")}}return e}},$(document).ready(function(){Visitor.init()});
var Cart=function(){this.blockId="products",this.blockLeft="products-cart-left",this.orderBtn=$("#products").find(".buttons.cart"),this.orderForm="#product-order-form",this.pushUrl="/"+this.blockId+"/load/pushtocart",this.updateUrl="/"+this.blockId+"/load/updatecart",this.PROMOCODE_FORALL=0,this.PROMOCODE_PERCENT=1,this.PROMOCODE_CURRENCY=2,this.PROMOCODE_ARTICUL=3,this.promocode=null,this.loadEvents()};$.extend(Cart.prototype,{loadEvents:function(){var e=this,t=$(".payments-step");e.paramsNotSelectedClass="not-selected",e.hasStore=t.length>0,e.order_info=$("#view-cart-show"),e.client_info=$("#user-info");var r=$("#top-body:not(.cabinet)"),a=function(){var t=$(".contacts-step"),r=$(".cart-step"),a=$(".pay-step");t.find(".separate").removeClass("arrow_step_fl").addClass("arrow_step_fr"),a.find(".separate").removeClass("arrow_step").addClass("arrow_step_fl"),r.removeClass("active"),t.addClass("active");var o=$("input.delivery-choose:checked");if(o.length){var n=parseInt(o.data("dlvr"));$("#product-order-form").find("#dlvrId").val(n)}e.client_info.show(),$("html,body").animate({scrollTop:$(".order-steps").offset().top-30},100),e.order_info.hide()};$(document).on("change",e.order_info.find("tr:not(.deleted-item) .num-items").selector,function(){return 0==e.order_info.find("tr:not(.deleted-item) .num-items.error").length&&e.order_info.find(".btn-contact-step").removeClass("disable"),e.update(this,"update",!0)}),$(document).on("click",e.order_info.find(".btn-contact-step:not(.disable)").selector,function(){return Cart.countUpdated?($(document).off("toContactStep"),$(document).on("toContactStep",function(){a()})):a(),!1}),$(".prev-step-contacts, .prev-step").keypress(function(){return!1}),e.hasStore&&($(document).on("click",e.client_info.find(".btn-payments-step").selector,function(){if($(e.orderForm).valid()){var r=$(".contacts-step"),a=($(".cart-step"),$(".pay-step"));r.find(".separate").removeClass("arrow_step_fr").addClass("arrow_step"),a.find(".separate").removeClass("arrow_step_fl").addClass("arrow_step_fr"),r.removeClass("active"),a.addClass("active"),t.show(),$("html,body").animate({scrollTop:$(".order-steps").offset().top-30},100),e.client_info.hide()}return!1}),$(document).on("click",t.find(".prev-step-contacts").selector,function(){var r=$(".contacts-step"),a=($(".cart-step"),$(".pay-step"));return r.find(".separate").removeClass("arrow_step").addClass("arrow_step_fr"),a.find(".separate").removeClass("arrow_step_fr").addClass("arrow_step_fl"),r.addClass("active"),a.removeClass("active"),t.hide(),e.client_info.show(),!1})),$(document).on("click",e.client_info.find(".prev-step").selector,function(t){return e.toCartStep(),!1}),$(document).on("click",this.orderBtn.selector,function(){return e.grabParamsAndAdd(this)}),$(document).on("click","#products .product-item .cart-btn",function(){return e.addToCart(this,!0)}),$(document).on("click",r.find(".cart-item .delete").selector,function(){return e.update(this,"delete")}),$(document).on("click",r.find("#view-cart .delete-item").selector,function(){return e.update(this,"delete",!0)}),$(document).on("change","#products-cart-left .num-items",function(){return e.update(this)}),$(document).on("click",r.find("#view-cart .restore-item").selector,function(){return e.restoreItem(this)}),$(document).on("click",e.client_info.find(".btn-send").selector,function(){return $("#product-order-form").submit(),!1}),$(document).on("change",'.payments-step input[data-name="paymethod_grid9"]',function(){return $("#product-order-form").submit(),!1}),e.submitOrderForm(),$(document).on("change","#cart-inner #total-summ span",function(){return e.summDeliveryPrice($(this).html())}),$("#delivery-choose").find(".delivery-choose").change(function(){var e=$("input.delivery-choose:checked");$(".without-delivery").toggle(e.hasClass("delivery-type-2")),$(".with-delivery").toggle(!e.hasClass("delivery-type-2"));var t=parseInt(e.data("dlvr"));return $("#product-order-form").find("#dlvrId").val(t),$("#cart-inner").find("#total-summ span").trigger("change"),!1}),$(document).on("change","#product-params-view .ptype-view-select",function(){return e.updateProductCost(this)});var o=$("#promocode-form");$(document).on("click",o.find(".buttons").selector,function(){return e._checkPromoCode(this)}),$(document).on("change",o.find("input").selector,function(){return e._checkPromoCode(this)}),$("#product-order-form").find(".vertical-radio input:radio").prop("checked",!1),$(document).on("click","#view-cart input[type=radio]",function(){var e=$(this);"payments-14"==e.attr("id")?$("#qiwi_phone_container").show():$("#qiwi_phone_container").hide(),"payments-204"==e.attr("id")?$("#pscb_phone_container").show():$("#pscb_phone_container").hide()}),$.validator.addMethod("payment_qiwi_phone",function(e,t){return $("#payments-14").attr("checked")?(e=e.replace(/[^\d]/g,""),this.optional(t)||/^(7|8)\d{10}$/i.test(e)):!0},view.translate("Введите корректный номер QIWI кошелька")),$.validator.addMethod("phone",function(e,t){var r=e.trim();return this.optional(t)||/^[+]?(\d)+$/i.test(r)},view.translate("Только цифры и +. Пример: +79123456789")),$.validator.addMethod("payment_pscb_phone",function(e,t){return $("#payments-204").attr("checked")?(e=e.replace(/[^\d]/g,""),this.optional(t)||/^(7|8)\d{10}$/i.test(e)):!0},view.translate("Введите корректный номер ПСКБ кошелька")),$.validator.addMethod("onecheck",function(){return $("#accept_agreement:checked").length>=1},"Принять условия публичной оферты"),$(document).on("change",'.payments-step input[data-name="paymethod"]',function(){var e=$('input[data-name="paymethod"]:checked');if(e.length>0){var t=$(".payments-step .btn-send"),r=e.val();0==r||2==r||1==r?t.html(view.translate("Отправить заказ")):t.html(view.translate("Перейти к оплате")),t.removeClass("disable")}})},toCartStep:function(){var e=$(".contacts-step"),t=$(".cart-step"),r=$(".pay-step");r.find(".separate").removeClass("arrow_step_fl").removeClass("arrow_step_fr").addClass("arrow_step"),e.find(".separate").removeClass("arrow_step_fr").addClass("arrow_step_fl"),t.addClass("active"),e.removeClass("active"),r.removeClass("active"),$(".payments-step").hide(),this.client_info.hide(),this.order_info.show()},_checkPromoCode:function(){var e=$("#promocode-form").find("input").val(),t=this;return Cart.countUpdated=!0,$.post("/products/load/getdiscount",{code:e},function(r){try{void 0!=r&&1==r.success?(t.calculateSumm(r.promocode),$("#promocode").val(e),$("#total-discount-element").css("display","table-row")):0==r.success&&""!=r.messages&&(t.promocode=null,t.calculateSumm(),$("#total-discount-element").css("display","none"))}catch(a){ntNotification.showError("Произошла ошибка")}setTimeout(function(){Cart.countUpdated=!1,$(document).off("toContactStep")},10)},"json"),!1},getParamsValues:function(e){var t=e.find(".ptype-view-wrapper select"),r=[],a=this;return t.each(function(){parseInt(this.value)&&r.push(this.value),a.paramIsSelected($(this))}),t.length==r.length?r:[]},grabParams:function(e){var t=[],r=$("#product-params-view");return r.length<=0?void e(t):(t=this.getParamsValues(r),void(t.length?e(t):ntNotification.showWarning("Выберите все параметры",4e3)))},grabParamsAndAdd:function(e){var t=this;t.grabParams(function(r){t.addToCart(e,!1,r)})},addToCart:function(e,t,r){var a=1==t?$(e).parents(".product-item"):$(e).parents(".item-content"),o=r||[];if(a.length>0){var n=$(a).attr("id").replace("item","")||0,i=t?void 0:e;this.push({itemId:n,num:1,getcart:1,button:i,productParams:o})}return!1},push:function(e){var t=this;return void 0!=e&&$.post(t.pushUrl,{cid:e.itemId,num:e.num,getcart:e.getcart||0,productParams:e.productParams},function(r){try{if(_.isUndefined(r)||1!=r.success){var a=void 0!=r.msg?r.msg:"Произошла ошибка, попробуйте  позже";throw new Error(a)}if(!_.isUndefined(r)){var o=$("<div>"+r.cart+"</div>").find("#"+t.blockLeft),n=$("#"+t.blockLeft);n.length>0?n.replaceWith(o):$(".cart-is-empty").replaceWith(o)}"restore"==e.action&&t.markItem(e.elementId,!0),e.callback&&e.callback(),void 0!=e.button&&Notifier.showNotice($(e.button).parent(),view.translate("Товар добавлен"),!0),$(document).trigger("cart.update")}catch(i){ntNotification.showError(i.message)}},"json"),!1},update:function(e,t,r){e=$(e);var a=this,o=t||"update",n=r||!1,i=n?e.parents("tr").eq(0).attr("id").replace("item",""):e.parents(".cart-item").eq(0).data("cid");if(Cart.countUpdated=!0,void 0!=i){var s={cid:i,act:o};if("update"==o){var c=e.val();if(!view.isInt(c)||0>c)return e.val(e.data("value")),Cart.countUpdated=!1,!1;0==c?s.act="delete":$.extend(s,{num:c})}$.post(a.updateUrl,s,function(t){try{if(void 0==t||1!=t.success){if(t.noProductInStock)return a.showNumErrors(t.noProductInStock),e.val(e.data("value")),void setTimeout(function(){Cart.countUpdated=!1,$(document).off("toContactStep")},10);void 0!=t.num&&e.val(e.data("value"));var r=t.msg||view.translate("Произошла ошибка, попробуйте  позже");throw new Error(r)}var i=e.data("pid"),d=e.data("price"),p=$("#cart-inner").find('.price-info[rel="product-'+i+'"]');switch(o){case"update":0==c&&(n?a.markItem(s.cid):a.removeItem(s.cid));var l=d*c;l=parseFloat(l.toFixed(2)),p.html(l),a.calculateSumm(),e.data("value",e.val());break;case"delete":n?a.markItem(s.cid):a.removeItem(s.cid)}$(document).trigger("cart.update")}catch(u){ntNotification.showError(u.message)}setTimeout(function(){Cart.countUpdated=!1,$(document).off("toContactStep")},10)},"json")}return!1},removeItem:function(e){$("#cid"+e).remove(),0==$("#"+this.blockLeft+" .cart-item").length&&$("#"+this.blockLeft).replaceWith('<div class="cart-is-empty">')},markItem:function(e,t){var r,a;if(void 0!=e){var o=t||!1,n=$("#item"+e);o?(r="delete-item",a=""):(r="restore-item",a="deleted-item"),n.find(".cart-manage span").attr("class",r),n.attr("class",a),this.calculateSumm()}return!1},restoreItem:function(e){var t=this,r=$(e).parents("tr.deleted-item").eq(0);if(r.length>0){var a=r.attr("id"),o={itemId:r.data("pid"),elementId:a.replace("item",""),action:"restore"},n=$("#"+a+" .num-items"),i=parseInt(n.val());0==i&&(i=1,n.val(1),o.callback=function(){t.update(n[0],"update",!0)}),o.num=i;var s=$(r).find(".product-params li"),c=[];s.length>0&&s.each(function(){c.push($(this).data("param"))}),o.productParams=c,this.push(o)}return!1},_calculateDiscount:function(e,t,r){var a,o=this,n=e.conditions,i=0;if(e.type==o.PROMOCODE_FORALL){for(a in n)i=n[a].discount;return parseFloat(r-parseFloat(r*parseFloat(i)/100)).toFixed(2)}if(e.type==o.PROMOCODE_PERCENT){for(a in n)r>parseFloat(n[a].condition)&&(i=parseFloat(n[a].discount));return parseFloat(r-parseFloat(r*parseFloat(i)/100)).toFixed(2)}if(e.type==o.PROMOCODE_CURRENCY){for(a in n)r>parseFloat(n[a].condition)&&(i=parseFloat(n[a].discount));return parseFloat(r-parseFloat(i)).toFixed(2)}if(e.type==o.PROMOCODE_ARTICUL){var s=$(t).data("articul"),c=$(t).val();for(a in n)if(n[a].discount==s&&""!=s)return i=parseFloat(n[a].condition),parseFloat(i*c)<parseFloat(r)?parseFloat(parseFloat(r)-parseFloat(i*c)).toFixed(2):parseFloat(r).toFixed(2)}return r},calculateSumm:function(e){var t=!0,r=this;void 0==e?e=r.promocode:r.promocode=e;var a=$("#cart-inner"),o=a.find("#total-summ span"),n=0,i=0;a.length>0&&(a.find('tr:not(".deleted-item") .product-summ').length?($(".cart-empty").hide(),$("#view-cart").find(".has_products").show()):($("#view-cart").find(".has_products").hide(),$(".cart-empty").show(),t=!1),a.find('tr:not(".deleted-item") .product-summ').each(function(){var t=$(this).html().replace("/[^d.]/",""),a=$(this).parent().parent().find("input");t=""!=t&&t>0?t:0,void 0!=e&&e.type==r.PROMOCODE_ARTICUL?(i+=parseFloat(t),n+=parseFloat(r._calculateDiscount(e,a,parseFloat(t)))):n+=parseFloat(t)})),void 0!=e&&e.type!=r.PROMOCODE_ARTICUL?(i=parseFloat(n).toFixed(2),n=r._calculateDiscount(e,null,parseFloat(n.toFixed(2)))):n=parseFloat(n).toFixed(2),$("#total-discount-element").find("#total-discount span").html(parseFloat(i-n).toFixed(2)),o.html(n),o.trigger("change");var s,c=$(".min-order-sum"),d=$(".btn-contact-step"),p=$(".shop-continue");c.length&&(s=c.data("min-sum"),s>n?(c.show(),p.show(),d.hide(),t=!1):(c.hide(),p.hide(),d.show())),t&&$(document).trigger("toContactStep")},summDeliveryPrice:function(e){var t=parseFloat(e),r=$("#delivery-choose");if(r.length>0){var a=r.find("input.delivery-choose:checked").val();if(void 0!=a&&t>0){var o=parseFloat(a.replace("/[^d.]/",""));r.find("#total-summ-order span").html((t+o).toFixed(2))}else r.find("#total-summ-order span").html(t.toFixed(2))}},getError:function(e,t){for(var r in e)if(e.hasOwnProperty(r)){if("object"==$.type(e[r]))return this.getError(e[r],r);var a={};return a.element=t,a.message=e[r],a}},showError:function(e,t,r){if(e.addClass("error"),!e.is('input[type="checkbox"]')){var a=$("<div class='error -text-error -pull-right -mg-l-10 error-message'>");a.text(t),r.find('label[for="'+e.attr("name")+'"]').append(a)}},deleteError:function(e,t,r){setTimeout(function(){e.removeClass("error"),t.find(".-text-error").remove()},r)},showNumErrors:function(e){var t,r,a,o,n=this,i=$("#products-cart-left-show");if(i.length)for(a in e)e.hasOwnProperty(a)&&(o=i.find("#cid"+a),r=o.find("input"),r.val(e[a]),r.addClass("error"),t=0!=e[a]?view.translate("Осталось")+": "+e[a]:view.translate("Нет в наличии"),o.append('<div style="margin-top: 3px" class="-text-error">'+t+"</div>"),n.deleteError(r,o,2e3));else for(a in e)e.hasOwnProperty(a)&&(r=$("#item"+a+" input.num-items"),r.addClass("error"),t=0!=e[a]?view.translate("Осталось")+": "+e[a]:view.translate("Нет в наличии"),o=r.parent(),o.append('<div class="-mg-t-10 -text-error">'+t+"</div>"),n.deleteError(r,o,2e3))},submitOrderForm:function(){var t=this,r=$(".payments-step"),a=r.find('input[type="radio"][name="payment"]'),o=$(this.orderForm);t.hasStore&&$(document).on("click",'.payments-step input[type="radio"]',function(){var e=parseInt(r.find('input[type="radio"]:checked').val()),t=r.find("label[for=accept_agreement]");0==e||2==e?t.hide():t.show()}),o.validate({submitHandler:function(n){return $(".payments-step .btn-send.disable").length?!1:(Notifier.showIndicatorBtn($(".btn-send")),void o.ajaxSubmit({dataType:"json",success:function(i){if(i.success)if(t.hasStore&&0==a.filter("#payments-0:checked, #payments-2:checked, #payments-1:checked").length){var s=$(i.gateway_form);s.hide(),$("#view-cart").append(s),s.submit()}else window.location="/cart/checkout";else{if(Notifier.hideIndicatorBtn($(".btn-send")),i.noProductInStock)return t.toCartStep(),void t.showNumErrors(i.noProductInStock);if(i.message&&ntNotification.showError(i.message),i.errors){var c=t.getError(i.errors),d=$(n).find("#"+c.element);d.length>0?(t.hasStore&&r.find(".prev-step-contacts").trigger("click"),t.showError(d,c.message,o)):ntNotification.showError(e.message)}}}}))},showErrors:function(e,r){o.find(".error-message").remove(),$("input.error").removeClass("error");for(var a=0;a<r.length;a++){var n=r[a],i=$(n.element);t.showError(i,n.message,o)}},focusInvalid:!1,focusCleanup:!1,rules:{qiwi_phone:{required:!0,payment_qiwi_phone:!0},nhpay_phone:{required:!0,payment_pscb_phone:!0},accept_agreement:{onecheck:!0},name:{required:!0},email:{identity:!0,required:!0},phone:{required:!0,phone:!0}},messages:{qiwi_phone:{required:view.translate("Обязательное поле")},nhpay_phone:{required:view.translate("Обязательное поле")},comment:{maxlength:view.translate("Введено больше символов")},adress:{maxlength:view.translate("Введено больше символов")},name:{maxlength:view.translate("Введено больше символов"),required:view.translate("Обязательное поле")},email:{maxlength:view.translate("Введено больше символов"),required:view.translate("Обязательное поле"),email:view.translate("Неверный формат почты")},phone:{maxlength:view.translate("Введено больше символов"),required:view.translate("Обязательное поле")}}}),Visitor.bindInputCharCounter()},paramIsSelected:function(e){var t=e.parent();Number(e.val())>0?t.removeClass(this.paramsNotSelectedClass):t.addClass(this.paramsNotSelectedClass)},updateProductCost:function(e){var t=this,r=$("#products-show"),a={price:r.find(".product-content .old-price .product-price-data"),priceSale:r.find(".product-content #cost-by-impact .product-price-data")},o={price:Number(a.price.data("cost")),priceSale:Number(a.priceSale.data("cost"))};o.priceSale>=0&&($("#product-params-view").find(".ptype-view-wrapper select").each(function(){var e=$(this),r=e.find("option:selected"),a=parseFloat(r.data("impact"));t.paramIsSelected(e),o.price+=a,o.priceSale+=a}),o.price=o.price>0?o.price:0,o.priceSale=o.priceSale>0?o.priceSale:0,a.price.html(parseFloat(o.price.toFixed(2))),a.priceSale.html(parseFloat(o.priceSale.toFixed(2))))}}),$("document").ready(function(){window.Nethouse=window.Nethouse||{},window.Nethouse.cart=new Cart});
var Comments;$("document").ready(function(){Comments=function(){this.init()},Comments.prototype={maxImagesQuantity:5,types:{video:6,images:7},init:function(){var e=this;this.commentsAccept=!0,this.initAnswerBtnAllowed=!0,this.id="comment",this.block_id=$("#"+this.id).data("block-id"),this.widget_type=7,this.countSubComments=2,this.page=2,this.showMessage='<span class="comment-item__btn button button_for_comment-toggle-comments">'+view.translate("Показать все комментарии")+"</span>",this.hideMessage='<span class="comment-item__btn button button_for_comment-toggle-comments">'+view.translate("Скрыть комментарии")+"</span>",$("#comment_wrap").length?e.initComments():$(document).on("widget_init",function(){e.initComments()}),this.loadEvents()},initComments:function(){var e=this,t=$("#comment_wrap"),n=t.attr("class");if(0!=$(".widget-comments .comment_wrap").length){var o=$(".widget-comments > .comment_wrap");e.count_roots=o.length,e.prepareOutput(o,!0),t.find(".next_comments").click(function(){e.getWidgetComments(this)})}$(document).on("changeBlock","#comment",function(){var t=$("#comment_wrap");if(0!=t.length&&t.is(":hidden")){var n=$(".widget-comments > .comment_wrap");e.prepareOutput(n,!0),$(".all-comments .answer-btn").click(function(){e.getAnswer(this)}),"undefined"!=typeof CommentsUser&&CommentsUser.reloadEvents()}}),void 0!=n?(this.type=n,this.object=t.find(".comment").attr("id")):this.type="site",0!=t.length&&0!=t.find(".is_scroll").length&&this.commentsAccept&&(e.infiniteScroll(),this.commentsAccept=!1)},initScroll:function(){$("#comment_wrap")},loadEvents:function(){var e=this;$(document).on("click","#comment_wrap .addcomment",function(){var t=$("#form_wrap");return e._getSmallForm($(this),t,!1),!1}),$(document).on("click",".all-comments .answer-btn",function(){e.getAnswer(this)}),this.initAnswerBtnAllowed=!1,$(document).on("click",".fancybox-inner #comment_form .cancel",function(){var t=this;return $(t).parents("#comment_form").slideToggle(function(){e.hideFormAndRevalidate($(t))}),!1}),$(document).on("click",".all-comments .cancel, #comment_wrap .cancel",function(){return $(this).parents("#comment_form").hide(),$(this).parents(".answer-form").hide(),$(this).parents(".comment_wrap ").find(".up-arrow").hide(),e.hideFormAndRevalidate($(this)),!1}),$(document).on("click","#comment-edit .cancel, #comment-edit .close",function(){e.toggleBlock(e.id,"close")}),$(document).on("hideBlocks",function(){e.toggleBlock(e.id,"close")}),$(document).on("click","#comment .add-btn",function(){e.toggleBlock(e.id,"add");var t=$("#"+e.id+"-edit"),n=$("#"+e.id+" i.up-arrow");return $("i.up-arrow").remove(),n.length>0&&n.remove(),e._getSmallForm($(this),t,!1)}),$(document).on("click","#comment_form #reload",function(){e.reloadCaptcha()})},infiniteScroll:function(){var e=this;$(".end_comments").endlessScroll({fireOnce:!0,fireDelay:200,loader:"<img id='loader' src='/img/lazyload.gif'>",url:"/comment/load/getcomments",toElement:!0,params:{type:e.type,object:e.object,page:e.page},success:function(e,t){return e.success?(t.params.page++,e.next_page?$("#comment_wrap .is_scroll .per_page").html(e.count):(t.disable=!0,$("#comment_wrap .is_scroll").removeClass("is_scroll")),void $("#comment_wrap .all-comments").append(e.output)):!1},insertAfter:".all-comments article.comment_wrap:last",callback:function(){CommentsUser.reloadEvents()}})},prepareOutput:function(e,t){var n=this,o='<div class="button-show-'+n.id+' blue">'+n.showMessage+"</div>";e.each(function(){var e=$(this),i=e.find(".button-show-"+n.id),a=e.find(".comment_wrap");a.length>n.countSubComments?(0==i.length&&(e.children("div").after(o),e.find(".button-show-"+n.id).click(function(){n.showSubComments(this)})),(t||!i.hasClass("isshow"))&&(a.show(),e.find(".comment_wrap:lt("+(a.length-n.countSubComments)+")").hide())):0!=i.length&&(a.show(),i.remove())}),t&&($("#ajax-loader").remove(),$("#"+n.id+"_wrap").show())},showSubComments:function(e){$(".answer-form.comment_wrap").remove();var t=$("#comment-form");0!=t.length&&(t.parent().find(".item").show(),t.remove());var n=this,o=$(e);if(o.hasClass("isshow")){o.removeClass("isshow");var i=o.parent().find(".comment_wrap"),a=i.length;a>n.countSubComments&&(o.html(n.showMessage),o.parent().find(".comment_wrap:lt("+(a-n.countSubComments)+")").hide())}else o.addClass("isshow"),o.html(n.hideMessage),o.parent().find(".comment_wrap").show()},getAnswer:function(e){var t=this;$(e).parent().parent().find(".answer-form").remove();var n=$(e).parents(".item").attr("id").replace("item-",""),o=$('<article id="parent-'+n+'" class="answer-form"><div><div></article>');return $(e).parent().after(o),$("i.up-arrow").remove(),0!=$("#comment-edit:visible").length&&($("#comment_form").remove(),t.toggleBlock(t.id,"add")),t._getSmallForm($(e),o,!0),!1},hideFormAndRevalidate:function(e){var t=this,n=$(e).parents("form"),o=0!=$(e).parents(".fancybox-inner").length,i=n.parent(),a=n.clone();i.append(a),n.remove(),o?t.validateWindowForm(a):"site"==t.type?t.validateWidgetForm(a):t.validateForm(a),a.find(".js-comment-images__list").html(""),this.initImageUpload(a)},toggleBlock:function(e,t){$(".on-edit:not(.static)").hide(),$(".content-block").show(),$(".content-block").parents("section").addClass("on-view"),$("header.infoPlate").each(function(){0==$(this).parents("#"+e).length&&($(this).children(".edit-block").find("a").removeClass("active-btn"),$(this).find(".add-btn").removeClass("active-btn"))}),$("#header-wrapper .edit-block").find("a.active-btn").removeClass("active-btn"),$("#header-wrapper").attr("class","");var n=$("#"+e).hasClass("overt");if("edit"==t||"add"==t){var o="add"==t?"edit":"add";$("#"+e+" ."+t+"-btn").hasClass("active-btn")?($("#"+e+"-edit").hide(),$("#"+e+" .no-entry").show(),$("#"+e+"-show").show(),$("#"+e).addClass("on-view"),$("#"+e+" ."+t+"-btn").removeClass("active-btn")):($("#"+e+"-edit").show(),n||$("#"+e+"-show").hide(),$("#"+e+" .no-entry").hide(),$("#"+e).removeClass("on-view"),$("#"+e+" ."+t+"-btn").addClass("active-btn"),$("#"+e+" ."+o+"-btn").removeClass("active-btn"))}else $("#"+e+"-edit").hide(),$("#"+e+"-show").show(),$("#"+e+" .no-entry").show(),$("#"+e).addClass("on-view"),$("#"+e+" .edit-btn").removeClass("active-btn"),$("#"+e+" .add-btn").removeClass("active-btn");return void 0!=t||"contactsmain"!=e&&"contactssocnet"!=e||$("#content #"+e+"-form").remove(),!1},getWidgetComments:function(e){var t=this,n="/comment/load/getsitecomments";$("#comment_wrap .next_comments span").hide(),$("#comment_wrap .next_comments").append("<img id='loader' src='/img/lazyload.gif'>"),$.post(n,{page:t.page},function(e){if($("#comment_wrap #loader").remove(),e.success){t.page++;var n=$(e.output);t.prepareOutput(n),$(".all-comments.widget-comments").append(n),"undefined"!=typeof CommentsUser&&CommentsUser.reloadEvents(),this.initAnswerBtnAllowed&&n.find(".answer-btn").click(function(){t.getAnswer(this)}),e.next_page?$("#comment_wrap .next_comments span").show():$("#comment_wrap .next_comments").remove()}else $("#comment_wrap .next_comments span").show(),ntNotification.showError("Произошла ошибка")},"json")},initFormImages:function(e,t){e.find(".js-comment-image").each(function(){var t=$(this);t.find(".js-comment-image__delete").on("click",function(){t.remove(),e.find(".js-comment-images__upload").show()}.bind(this))})},getImagesQuatity:function(e){return e.find(".js-comment-images__list .js-comment-image:not(.upload-image_fail)").length},initImageUpload:function(e){e.find(".js-comment-images").show();var t,n=e.find(".js-comment-images__list"),o=e.find(".js-comment-images__upload"),i=o.data("upload-url"),a=["jpeg","png","gif","jpg"],r=$(".js-comment-image-tpl").html(),m=this.maxImagesQuantity-this.getImagesQuatity(e);0!=o.length&&(m>0&&o.show(),t=new Nethouse.ImageUploader(o[0],{multiple:!0,path:i}),t.preview(90,60,function(t,i){t=$(r).append(t),n.append(t),t.addClass("js-comment-image_"+i),t.find(".js-comment-image__delete").on("click",function(){t.remove();var n=this.getImagesQuatity(e);n<this.maxImagesQuantity&&o.show()}.bind(this))}.bind(this)).addExtensionFilter(a).addFileSizeFilter(5*Nethouse.Uploader.MB).on("before",function(){t.maxFiles=this.maxImagesQuantity-this.getImagesQuatity(e)}.bind(this)).on("filecomplete",function(t,i,a){if(t)return void ntNotification.showError(sprintf(view.translate("js_uploader_upload_file_fail"),a.name),6e3);var r=window.JSON.parse(i.response),m=new Nethouse.FileModel(r),s=this.getImagesQuatity(e);n.find(".js-comment-image_"+a.id).append(m.toInputFields(a.id,"attachments")),s>=this.maxImagesQuantity&&o.hide()}.bind(this)).on("error",function(e,t){var n=Nethouse.Uploader.Errors;switch(e){case n.EXTENSION:ntNotification.showError(sprintf(view.translate("js_uploader_extension_fail"),t.file.name,a.join(", ")),6e3);break;case n.MAX_SIZE:ntNotification.showError(sprintf(view.translate("js_uploader_max_size_fail"),t.file.name,"5 MB"),6e3);break;case n.MAX_FILES_COUNT:ntNotification.showError(sprintf(view.translate("js_uploader_files_count_fail"),this.maxImagesQuantity),6e3)}}.bind(this)))},_getSmallForm:function(e,t,n){var o=this;if($(".comment_wrap.answer-form").not(t).remove(),$("#comment_form").parents(".answer-form").remove(),$("section#comment #comment-edit #comment_form").remove(),$(".comment_wrap #comment_form").remove(),$(".comment_wrap .item").show(),n)var i=e.parents(".item").attr("id").replace("item-","");if(e.hasClass("active-btn")||"site"!=o.type||n){"site"==o.type&&e.append('<i class="up-arrow"></i>');var a=Notifier.getLoader();t.html('<div class="ajax-loader">'+a+"</div>");var r="/"+o.id+"/load/getform";$.post(r,{type:o.type,object:o.object,parent:i},function(n){var i,a;n.success?($("."+o.id+"_wrap #"+o.id+"_form").remove(),a=t.html(n.form),o.initFormImages(a.find("form")),o.initImageUpload(a.find("form")),"site"==o.type?(a.children("form").removeClass("fromTable").addClass("new-item"),o.validateWidgetForm(a.children("form"))):(o.ReloadEvents(e),o.validateForm(a.children("form")))):($("#"+o.id+" .no-entry").show(),i=$(n.form).closest(".block-error").length>0?n.form:"Ошибка",$("#comment-edit").empty(),Notifier.showError(i,"#comment-edit"))},"json")}return!1},getCookie:function(e){var t=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return t?decodeURIComponent(t[1]):void 0},ReloadEvents:function(e){var t=this;e.unbind("click"),e.click(function(){$(".comment_wrap #comment_form").remove(),$(".comment_wrap .item").show();var e=$("#comment_form");e.is(":hidden")?t.reloadCaptcha():e.hide()})},highlight:function(e,t){$(e).addClass(t)},unhighlight:function(e,t){$(e).removeClass(t).next(".errors")},showErrors:function(e,t){$("#comment_form .errors").remove(),$("#comment_form .error").removeClass("error");for(var n=0;n<t.length;n++){var o=t[n],i=$(o.element),a=$('<ul class="errors">');a.append($("<li>").text(o.message)),i.hasClass("cleditor")?a.insertAfter(i.parents(".cleditorMain").find("iframe")):a.insertAfter(i),this.settings.highlight.call(this,o.element,"error")}},validateWindowForm:function(e){var t=this;e.validate({showErrors:t.showErrors,unhighlight:t.unhighlight,highlight:t.highlight,submitHandler:function(e){return Notifier.showIndicator("comment_form",!1),$(e).ajaxSubmit({dataType:"json",success:function(e){if(Notifier.hideIndicator("comment_form",!1),e.success){if($(".fancybox-wrap #comment_form").slideToggle(),!e.approved)return t.cleanForm(),void t.notApprovedNotification();e.isNew?($(".fancybox-inner .all-comments").append(e.comment),0==$("#comment_wrap header .info h2").length&&$("#comment_wrap header .info").append('<h2 class="not_scroll">Комментарии</h2><div class="bold_sep"><hr></div>'),t.cleanForm()):$(".fancybox-inner .all-comments #item-"+e.item).parent().replaceWith(e.comment),"undefined"!=typeof CommentsUser?CommentsUser.reloadEvents():t.reloadCaptcha()}else e.captchaFaild?(t.reloadCaptcha(),t.captchaError()):($(".comment_wrap .item").show(),ntNotification.showError("Произошла ошибка"))},beforeSubmit:function(){Notifier.showIndicator("comment_wrap",!1)}}),!1},rules:t.rules,messages:t.messages,focusInvalid:!1,focusCleanup:!0})},validateForm:function(e){var t=this;e.validate({showErrors:t.showErrors,unhighlight:t.unhighlight,highlight:t.highlight,submitHandler:function(e){return Notifier.showIndicator("comment_form",!1),$(e).ajaxSubmit({dataType:"json",success:function(e){if(Notifier.hideIndicator("comment_form",!1),e.success){if($("#comment_form").hide(),$(".answer-form").remove(),!e.approved)return void t.notApprovedNotification();if(e.isNew){if(e.parent?$("#comment_wrap .all-comments #item-"+e.parent).parent().append(e.comment):$("#comment_wrap .all-comments").prepend(e.comment),t.cleanForm(),0!=$("#comment_wrap .no-comments").length)$("#comment_wrap .no-comments").replaceWith('<h2 class="not_scroll">Комментарии</h2>'),$("#comment_wrap .bold_sep").html("<hr/>");else if(0!=$("#comment_wrap .is_scroll").length){var n=$("#comment_wrap .is_scroll .per_page"),o=$("#comment_wrap .is_scroll .total"),i=parseInt(n.text())+1,a=parseInt(o.text())+1;o.html(a),n.html(i)}}else $(".all-comments #item-"+e.item).parent().replaceWith(e.comment);"undefined"!=typeof CommentsUser&&CommentsUser.reloadEvents()}else e.captchaFaild?(t.reloadCaptcha(),t.captchaError()):($(".comment_wrap .item").show(),ntNotification.showError("Произошла ошибка"))},beforeSubmit:function(){Notifier.showIndicator("comment_wrap",!1)}}),!1},rules:t.rules,messages:t.messages,focusInvalid:!1,focusCleanup:!0}),Visitor.bindInputCharCounter()},validateWidgetForm:function(e){var t=this;e.validate({showErrors:t.showErrors,unhighlight:t.unhighlight,highlight:t.highlight,submitHandler:function(e){return Notifier.showIndicator("comment_form",!1),$(e).ajaxSubmit({dataType:"json",success:function(e,n,o){if(Notifier.hideIndicator("comment_form",!1),e.success){if(!e.approved)return t.cleanForm(),t.notApprovedNotification(),void(e.parent?$("#comment_form").parent().hide():t.toggleBlock(t.id,"add"));if(e.isNew){$("#comment_form").parent().hide(),$("i.up-arrow").remove(),$("#comment .no-entry").remove();var i=$(e.comment);if(e.parent){var a=$("#comment .all-comments #item-"+e.parent).parent();a.append(i),t.prepareOutput(a,!1)}else t.toggleBlock(t.id,"add"),i.find(".answer-btn").click(function(){t.getAnswer(this)}),$("#comment .all-comments").prepend(i);t.cleanForm(),"undefined"==typeof CommentsUser&&t.reloadCaptcha()}else{var r=$("#comment .all-comments #item-"+e.item);r.parent().find("#comment_form").remove();var i=$(e.comment);i.find(".answer-btn").click(function(){t.getAnswer(this)}),r.replaceWith(i)}"undefined"!=typeof CommentsUser&&CommentsUser.reloadEvents()}else e.captchaFaild?(t.reloadCaptcha(),t.captchaError()):($(".comment_wrap .item").show(),ntNotification.showError("Произошла ошибка"))},beforeSubmit:function(){Notifier.showIndicator("comment_wrap",!1)}}),!1},rules:t.rules,messages:t.messages,focusInvalid:!1,focusCleanup:!0}),Visitor.bindInputCharCounter()},captchaError:function(){$("#comment_form #captcha-input").val("").addClass("error"),$("#comment_form #captcha-element").append('<ul class="errors"><li>'+view.translate("Неверно введены символы, указанные на картинке.")+"</li></ul>")},cleanForm:function(){$('#comment_form input[type="text"], #comment_form textarea').val(""),$("#comment_form #captcha-input").val("")},rules:{name:{required:!0,maxlength:40},commenttext:{required:!0,maxlength:3e3},"captcha[input]":{required:!0,minlength:6,maxlength:6}},messages:{name:{required:view.translate("Обязательное поле"),maxlength:view.translate("Максимальная длина")+" 40 "+view.translate("символов")},commenttext:{required:view.translate("Обязательное поле"),maxlength:view.translate("Максимальная длина")+" 3000 "+view.translate("символов")},"captcha[input]":{required:view.translate("Обязательное поле"),maxlength:view.translate("Введено не")+" 6 "+view.translate("символов"),minlength:view.translate("Введено не")+" 6 "+view.translate("символов")}},reloadCaptcha:function(){"undefined"==typeof CommentsUser&&$.post("/comment/load/captcha",function(e){e.success?($("#comment_form #captcha-element img").attr("src",e.image),$("#comment_form #captcha-id").val(e.captcha)):ntNotification.showError("Произошла ошибка")},"json")},notApprovedNotification:function(){ntNotification.showSuccess(view.translate("comment_is_not_approved"),6e3)}},Comments=new Comments});
!function(o,e){"use strict";o(document).on("click",".window .cancel, .window .close",function(){return o.magnificPopup.close(),!1});var n={openHtmlAjax:function(n,i,t){i=i||{},i.loaded=i.loaded||function(){},i.open=i.open||function(){},o.magnificPopup.open({tLoading:'<img src="/img/preloader.gif">',items:{type:"ajax",src:n},ajax:{settings:i.opts,tError:i.error},removalDelay:300,mainClass:"mfp-fade",showCloseBtn:!1,fixedContentPos:!1,callbacks:{beforeOpen:function(){o("html").addClass("modal-open")},parseAjax:function(o){i.loaded(o,this)},ajaxContentAdded:function(){o(".mfp-content").addClass("site-popup"),i.open()},close:function(){o("html").removeClass("modal-open"),e.history.pushState("",document.title,e.location.pathname)}}})},openHtml:function(n){this.hideLoader(),o.magnificPopup.open({tLoading:'<img src="/img/preloader.gif">',items:{src:n,type:"inline"},removalDelay:300,mainClass:"mfp-fade",showCloseBtn:!1,callbacks:{open:function(){o(".mfp-content").addClass("site-popup")},close:function(){e.location.pushState("",document.title,e.location.pathname)}}})},showLoader:function(){o("body").prepend('<div class="-screen-loader"><div><div class="-screen-loader-img"><img src="/img/preloader.gif"></div></div></div>')},hideLoader:function(){o("body > .-screen-loader").remove()},close:function(){o.magnificPopup.close()}};e.Nethouse=e.Nethouse||{},e.Nethouse.Modal=n}(window.$,window);
$(document).ready(function(){var e,n=$(".notify-line");n.length&&(e=$("<style> .goog-te-banner-frame { top: "+n.height()+"px; } </style>"),$("head").append(e),$(".notify-line__close").on("click",function(){var t=new Date;return t.setMinutes(t.getMinutes()+5),document.cookie="notify_line=1; path=/; expires="+t.toUTCString(),n.remove(),$(".notify-line__height").remove(),e.remove(),!1}))});
var ntNotification={templates:{},notifications:[],getTemplate:function(t,i){var e=this;this.templates[t]?i(e.templates[t]):$.get("/html/ru_RU/utils/notification.html",function(o){e.templates[t]=o,i(e.templates[t])})},getTop:function(t){return parseInt(t.css("top").replace("px",""))},moveAll:function(t,i){var e=this;_.forEach(e.notifications,function(o,n){if(n>=t)if(t!=n){var a=e.notifications[n-1].elm;i=i+a.outerHeight()+5,o.elm.animate({top:i+"px"},200)}else o.elm.animate({top:i+"px"},200)})},deleteNotification:function(t,i){var e=this,o=_.indexOf(e.notifications,t),n=e.getTop(t.elm);t.timeout&&clearTimeout(t.timeout),e.notifications=_.without(e.notifications,t),t.elm.stop(!0,!0),i?t.elm.animate({left:t.elm.width()+"px",opacity:0},200,function(){t.elm.remove(),e.moveAll(o,n)}):t.elm.animate({top:n-t.elm.outerHeight()+"px",opacity:0},200,function(){t.elm.remove(),e.moveAll(o,n)})},shake:function(t){for(var i=70,e=5,o=5,n=0;o+1>n;n++)$(t).animate({"margin-left":n%2==0?e:-1*e},{duration:i,queue:!0});$(t).animate({"margin-left":0},i)},getPageX:function(t){var i=0;if("touchstart"==t.type||"touchmove"==t.type||"touchend"==t.type||"touchcancel"==t.type){var e=t.originalEvent.touches[0]||t.originalEvent.changedTouches[0];i=e.pageX}else("mousedown"==t.type||"mouseup"==t.type||"mousemove"==t.type||"mouseover"==t.type||"mouseout"==t.type||"mouseenter"==t.type||"mouseleave"==t.type)&&(i=t.pageX);return i},show:function(t,i,e){var o=this,n=CryptoJS.SHA1(i).toString(),a=_.findWhere(o.notifications,{id:n}),c=!_.isUndefined(e)&&e;if(a){if(a.elm.stop(!0,!0),o.shake(a.elm),a.timeout){clearTimeout(a.timeout);var s=a.elm.find(".-notification-timer");s.stop(!0,!0),s.css({width:""}),s.animate({width:0},a.time),a.timeout=setTimeout(function(){o.deleteNotification(a)},a.time)}}else this.getTemplate(t,function(a){window.view&&window.view.translate&&(i=window.view.translate(i));var s={id:n,elm:$(_.template(a)({type:t,message:i,hasTimer:c}))};if(s.elm.data("id",n),o.notification_box||(o.notification_box=$('<div class="-notification-box"></div>'),$(document).on("click",".-notification-close, .-notification-box .-notification-icon",function(){var t=_.findWhere(o.notifications,{id:$(this).parent().eq(0).data("id")});t&&o.deleteNotification(t)}),$(document).on("touchstart",".-notification",function(t){var i=_.findWhere(o.notifications,{id:$(this).data("id")});i.elm.css("left",0);var e=o.getPageX(t),n=i.elm.offset();$(document).on("touchmove.notification",function(t){var a=o.getPageX(t),c=a-e;c>0?i.elm.css({left:c+"px"}):n.left<a?e=a:$(document).off("touchmove.notification touchend.notification"),c>100&&($(document).off("touchmove.notification touchend.notification"),o.deleteNotification(i,!0))}),$(document).on("touchend.notification",".-notification",function(){i.elm&&i.elm.css({left:0}),$(document).off("touchmove.notification touchend.notification")})}),o.notification_box.css({top:0}),$("body").append(o.notification_box)),s.elm.css({opacity:0,top:0}),o.notification_box.append(s.elm),0!=o.notifications.length){5==o.notifications.length&&o.deleteNotification(o.notifications[o.notifications.length-1]);var f,m=function(){};_.forEach(o.notifications,function(t,i){if(i==o.notifications.length-1&&(m=function(){s.elm.animate({opacity:1},{duration:100,queue:!0})}),0!=i){var e=o.notifications[i-1].elm;f=f+e.outerHeight()+5,t.elm.animate({top:f+"px"},100,m)}else f=s.elm.outerHeight()+5,t.elm.animate({top:f+"px"},100,m)})}else s.elm.animate({opacity:1},100);o.notifications.unshift(s),c&&(s.time=e,s.elm.find(".-notification-timer").animate({width:0},e),s.timeout=setTimeout(function(){o.deleteNotification(s)},s.time))})},showError:function(t,i){i=_.isUndefined(i)?5e3:i,this.showMessage(t,"error",i)},showWarning:function(t,i){i=i===!0&&5e3||i,this.showMessage(t,"warning",i)},showSuccess:function(t,i){i=_.isUndefined(i)?5e3:i,this.showMessage(t,"success",i)},showMessage:function(t,i,e){var o=this;if(i=i||"error",e=_.isUndefined(e)?"warning"==i?0:5e3:e,/^\/[a-z]+/.test(t)){var n=$("body").data("lang");$.get("/html/"+n+t,function(t){o.show(i,t,e)})}else o.show(i,t,e)}};
!function(t,o,e,r,i){"use strict";t.validator.addMethod("cMaxlength",t.validator.methods.maxlength,r.translate("Длина поля должна быть до {0} символов")),t.validator.addMethod("required",t.validator.methods.required,r.translate("Обязательное поле")),t.validator.addMethod("cRequired",t.validator.methods.required,r.translate("Обязательное поле")),t.validator.addMethod("identity",function(t,o){var e=t.trim();return this.optional(o)||/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(e)},r.translate("Введите корректный email")),t.validator.addMethod("email",t.validator.methods.identity,r.translate("Пожалуйста, введите правильный эл. адрес")),t.validator.addMethod("cMinCurrency",t.validator.methods.min,t.validator.format(r.translate("Минимальная сумма платежа - {0}руб."))),t.validator.addMethod("phone",function(t,o){var e=t.trim();return this.optional(o)||/^[+]?(\d)+$/i.test(e)},r.translate("Только цифры и +. Пример: +79123456789")),t.validator.addClassRules({"dynamic-form-required":{cRequired:!0},"dynamic-form-text":{cMaxlength:100},"dynamic-form-textarea":{cMaxlength:1e3},"dynamic-form-phone":{phone:!0},"dynamic-form-email":{identity:!0},"dynamic-form-money":{cMinCurrency:0}});var a=function(t,o){this.type=t,this.options=o||{},this.selector=".dynamic-form-"+t,this.btnSelector=".dynamic-form-button-"+t};o.extend(a,{formIsShow:function(o){t(document).trigger("dynamic-form-show."+o)},types:{FORM_TYPE_FEEDBACK:0,FORM_TYPE_CALLBACK:1,FORM_TYPE_ORDER:2,FORM_TYPE_LEAD:3,FORM_TYPE_PAY:4,FORM_TYPE_LEAD_MRB:5},tooltipError:{trigger:"custom",theme:"tooltipster-error",speed:0,positionTracker:!0,offsetY:-6,position:"top"}}),o.extend(a.prototype,{init:function(){var o=t(this.selector);t(document).on("dynamic-form-show."+this.type,function(){i.setTimeout(function(){this.addButtonEvent(),this.validateForm()}.bind(this),100)}.bind(this)),o.length&&(this.addButtonEvent(),this.validateForm())},destroy:function(){t(document).off("dynamic-form-show."+this.type),t(this.btnSelector).off("click")},addButtonEvent:function(){var o=this;t(this.btnSelector).on("click",function(){t(this).parent().parent().find(o.selector).submit()})},processErrors:function(t,e){return o.reduce(t,function(t,r){return t.concat(o.map(r,function(t,r){return{element:e.find("[name="+r+"]"),message:o.values(t)[0]}}))},[])},validateForm:function(){var n=t(this.selector),u=this;n.each(function(){var n=t(this),s=n.validate({submitHandler:function(){return"function"==typeof u.options.beforeSubmit&&u.options.beforeSubmit(),n.locked?!1:(n.locked=!0,void n.ajaxSubmit({dataType:u.options.dataType||"json",success:function(t,o,a){var F;return n.locked=!1,"function"==typeof u.options.afterSubmit&&u.options.afterSubmit(t),t.success===!1?void(t.errors?(F=u.processErrors(t.errors,n),s.errorList=F,s.showErrors()):(F=t.msg||r.translate("Ошибка при отправке формы"),e.showError(F))):(n[0].reset(),e.showSuccess(r.translate("Форма успешно отправлена")),void i.history.pushState("",document.title,i.location.pathname))},error:function(t,o,e){this.success({success:!1,msg:e},o,t)}}))},focusInvalid:!1,focusCleanup:!1,showErrors:function(e,r){var i=n.find("input, textarea");i.each(function(){var o=t(this);o.removeClass("error").addClass("valid"),o.hasClass("tooltipstered")&&o.tooltipster("hide")}),o.forEach(r,function(o){var e=t(o.element);e.hasClass("tooltipstered")||e.tooltipster(a.tooltipError),e.tooltipster("content",o.message),e.tooltipster("show"),e.removeClass("valid").addClass("error")})}})})}}),i.Nethouse=i.Nethouse||{},i.Nethouse.DynamicForm=a}(window.$,window._,window.ntNotification,window.view,window);
!function(t,n){"use strict";setTimeout(function(){t(document).ready(function(){var t=new n(n.types.FORM_TYPE_LEAD_MRB,{dataType:"text",afterSubmit:function(){window.location.hash="lead-form-send"}});t.init()})},1e3)}(window.$,window.Nethouse.DynamicForm);
!function(t){var e,a="https://money.yandex.ru/eshop.xml";e=function(e){var a=this;a.element=t(e),a.init()},t.extend(e.prototype,{init:function(){var t=this;t.currentForm=t.element.find("form"),t.formId=t.currentForm.attr("id"),t.loadEvents(),t.addValidateMethods(),t.initFormValidate()},loadEvents:function(){var e=this;t(document).on("click","#"+e.formId+" .payments",e.submitHandler.bind(e))},addValidateMethods:function(){t.validator.addMethod("required",t.validator.methods.required,view.translate("Обязательное поле")),t.validator.addMethod("email",t.validator.methods.email,view.translate("Пожалуйста, введите правильный эл. адрес")),t.validator.addMethod("maxlength",t.validator.methods.maxlength,t.validator.format(view.translate("Пожалуйста, не вводите более {0} символов"))),t.validator.addMethod("min",t.validator.methods.min,t.validator.format(view.translate("Минимальная сумма платежа - {0}руб.")))},initFormValidate:function(){var e=this;t(document).ready(function(){e.validation=t("#"+e.formId).validate(e)})},submitHandler:function(){var e,r=this,n=t("#"+r.formId),o=n.attr("action"),i=n.serialize();n.valid()&&t.post(o,i,function(n){if(n.success===!1)throw n.errors?(_.forEach(n.errors,function(t,e,a){a[e]=_.reduce(t,function(t,e){return[t,e].join("\n")},"")}),r.validation.showErrors(n.errors),_.uniq(_.values(n.errors)).join("")):(e="Ошибка при обработке формы оплаты",ntNotification.showError(e)),Error(e);n.paymentType=i.match(/payment=(.*)/)[1];var o=document.createElement("form");o.setAttribute("action",a),o.setAttribute("method","POST"),_.forEach(n,function(t,e){var a=document.createElement("input");a.type="hidden",a.name=e,a.setAttribute("value",t),o.appendChild(a)}),t("body").append(o),o.submit()},"json")}}),setTimeout(function(){t(document).ready(function(){_.map(t(".mrb-form_payment"),function(t){new e(t)})})},1e3)}(jQuery);
!function(n,i){"use strict";n(document).ready(function(){var n=new i(i.types.FORM_TYPE_LEAD);n.init()})}(window.$,window.Nethouse.DynamicForm);
!function(e){function t(i){var s={url:"",name:"",size:0,timestamp:0,type:t.TYPE_IMAGE};i=e.extend({},s,i),this.url=i.url,this.name=i.name,this.size=i.size,this.timestamp=i.timestamp,this.type=i.type}window.Nethouse=window.Nethouse||{};var i=window.Nethouse;t.TYPE_IMAGE=1,t.prototype.properties=["url","name","size","timestamp","type"],t.prototype.toInputFields=function(e,t){var i=document.createElement("input"),s=document.createElement("div");return s.className="js-file-fields js-file-fields_"+e,i.className="js-file-field",i.type="hidden",this.properties.forEach(function(n){i.name=t+"["+e+"]["+n+"]",i.value=this[n],s.appendChild(i),i=i.cloneNode(!0)}.bind(this)),s},i.FileModel=t}(window._);
!function(){function e(e,i){this.filters=[],this.path=i.path,this.maxFiles=i.maxFiles||0,this.fieldName=i.fieldName||"file",this.beforeUpload=this.beforeUpload||function(){};var t=document.createElement("input");t.name="files",t.type="file",i.multiple&&(t.multiple="multiple"),e.appendChild(t),e.className+=" fileapi",this.events={},window.FileAPI.event.on(t,"change",this.inputChanges.bind(this))}function i(i,t){t=window.FileAPI.extend({path:"/putimg"},t),e.call(this,i,t)}window.Nethouse=window.Nethouse||{};var t=1e4,r=window.Nethouse;e.Errors={MAX_SIZE:1,MIN_SIZE:2,EXTENSION:3,MAX_WIDTH:4,MAX_HEIGHT:5,MIN_WIDTH:6,MIN_HEIGHT:7,MAX_FILES_COUNT:8},e.MB=FileAPI.MB,e.KB=FileAPI.KB,e.prototype.call=function(e){var i=Array.prototype.slice.call(arguments,1);this.events[e]&&this.events[e].forEach(function(e){e.apply(this,i)}.bind(this))},e.prototype.on=function(e,i){return this.events[e]=this.events[e]||[],this.events[e].push(i),this},e.prototype.inputChanges=function(i){var t=window.FileAPI,r=t.getFiles(i);t.filterFiles(r,function(e,i){for(var t=0;t<this.filters.length;t++)if(!this.filters[t](e,i))return!1;return!0}.bind(this),function(i,r){if(this.call("before",i,r),i.length){this.maxFiles&&i.length>this.maxFiles&&(this.call("error",e.Errors.MAX_FILES_COUNT,{filesCount:i.length,maxFilesCount:this.maxFiles}),i=i.slice(0,this.maxFiles)),this.beforeUpload(i,r);var s={url:this.path,upload:function(e,i){this.call("upload",e,i)}.bind(this),progress:function(e,i,t,r){this.call("progress",e,i,t,r)}.bind(this),filecomplete:function(e,i,t,r){this.call("filecomplete",e,i,t,r)}.bind(this),complete:function(e,i){this.call("complete",e,i)}.bind(this)};s.files={},s.files[this.fieldName]=i,t.upload(s)}}.bind(this)),t.reset(i.currentTarget)},e.prototype.addFileSizeFilter=function(i,t){return t=t||0,this.filters.push(function(r){return r.size>i?(this.call("error",e.Errors.MAX_SIZE,{file:r,maxSize:i}),!1):r.size<t?(this.call("error",e.Errors.MIN_SIZE,{file:r,minSize:t}),!1):!0}.bind(this)),this},e.prototype.addExtensionFilter=function(i){var t=new RegExp("^.+\\.("+i.join("|")+")$","i");return this.filters.push(function(i){return t.test(i.name)?!0:(this.call("error",e.Errors.EXTENSION,{file:i}),!1)}.bind(this)),this},r=r||{},r.Uploader=e,i.prototype=Object.create(e.prototype),i.prototype.constructor=i,i.prototype.addMaxSizeFilter=function(i,t){return this.filters.push(function(r,s){return i&&s.width>i?(this.call("error",e.Errors.MAX_WIDTH,{file:r,width:s.width,maxWidth:i}),!1):t&&s.height>t?(this.call("error",e.Errors.MAX_HEIGHT,{file:r,height:s.height,maxHeight:t}),!1):!0}.bind(this)),this},i.prototype.addMinSizeFilter=function(i,t){return this.filters.push(function(r,s){return i&&s.width<i?(this.call("error",e.Errors.MIN_WIDTH,{file:r,width:s.width,minWidth:i}),!1):t&&s.height<t?(this.call("error",e.Errors.MIN_HEIGHT,{file:r,height:s.height,minHeight:t}),!1):!0}.bind(this)),this},i.prototype.preview=function(e,i,t){return this.previewSize={width:e,height:i},this.events.progress=[function(e,i){var t=document.querySelectorAll(".upload-image_"+i.id+" .upload-image__progress")[0],r=e.loaded/e.total*100;t&&90>r&&(t.style.top=e.loaded/e.total*100+"%")}],this.events.filecomplete=[function(e,i,t){var r=document.querySelectorAll(".upload-image_"+t.id)[0];if(r){if(e)return void(r.className+=" upload-image_fail");r.className+=" upload-image_uploaded",r.querySelectorAll(".upload-image__progress")[0].style.top="100%"}}],this.events.preview=t,this},i.prototype.beforeUpload=function(e){if(this.events.preview){var i=window.FileAPI;i.each(e,function(e){e.id=t++,i.Image(e).preview(this.previewSize.width,this.previewSize.height).get(function(i,t){var r=document.createElement("div");r.className="upload-image upload-image_"+e.id,r.innerHTML='<div class="upload-image__progress"></div><div class="upload-image-file__status"></div>',r.appendChild(t),this.events.preview(r,e.id)}.bind(this))}.bind(this))}},r.ImageUploader=i}();
!function(i){"use strict";var e={init:function(){this.addMobileSelector()},addMobileSelector:function(){isMobile.any===!0&&i("body").addClass("mobile-device")}};i(document).ready(function(){e.init()})}(jQuery);